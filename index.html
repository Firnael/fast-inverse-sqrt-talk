<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/ico" href="favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fast Inverse Square Root - The Talk</title>
</head>

<body>
  <div class="reveal">
    <div class="slides">

      <!-- 1. Introdution -->
      <section data-background-image="/1/splash.jpg" data-transition="fade" class="scrim grey">
        <h1 class="main-title r-fit-text">The (In)glorious<br />Function</h1>
        <aside class="notes">
          Bonjour à tous, bienvenue à tous au MaxCamp 2023, pour ceux qui ne me connaissent pas
          je m'appelle Audren Burlot, et je suis honoré de démarrer la journée avec ce talk
          qui s'intitule "The Inglorious Function".
        </aside>
      </section>
      <section data-background-image="/1/splash.jpg" class="blurred">
        <section>
          L'histoire d'une fonction
          <aside class="notes">
            Aujourd'hui je vais vous raconter l'histoire d'une fonction.
            Une fonction trouvée il y a 20 dans le code source d'un jeu sorti il y a 24 ans.
          </aside>
        </section>
        <section>
          <img src="/1/cake-aux-olives.jpeg" />
          <aside class="notes">
            On va parler de Quake 3, de normalisation de vecteurs, de logarithme de base 2, de ce bon vieux Newton,
            et de sorcellerie
          </aside>
        </section>
        <section>
          <img class="r-stretch" src="/1/ah-shit.gif" />
          <aside class="notes">
            Mais avant de vous parler de code, il faut qu'on revienne un peu en arrière
          </aside>
        </section>
      </section>

      <!-- 2. Storytime -->
      <section data-background-image="/2/pere-castor.jpeg" data-transition="fade" class="scrim sepia">
        <h2>2.<br />Storytime !</h2>
      </section>
      <section data-background-image="/2/pere-castor.jpeg" class="blurred">
        <section>
          <img class="r-stretch" src="/2/softdisk-offices.jpeg" />
          <aside class="notes">
            Notre histoire commence au début des années 80, avec une entreprise qui se nomme Softdisk Publishing.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/softdisk-publishing-logo.webp" />
              <img src="/2/shreveport.jpg" />
              <p>Shreveport - Louisiane</p>
            </div>
            <div class="item">
              <img src="/2/harbinger.webp" />
              <p>1981</p>
            </div>
          </div>
          <aside class="notes">
            D'abord un club un club d'informatique, puis une entreprise en 1981, Softdisk est une boite
            d'édition de magazines sur disquette divers et variés à parution mensuelle.
            A droite le premier diskmag de la boite : The Harbinger, pour Apple II.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/floppy-disks.jpeg">
          <aside class="notes">
            Un magazine sur disquette, "diskmag" en anglais et même "magazette" en français,
            est un magazine souvent amateur distribué sous format électronique afin d'être lu sur un ordinateur.
            Ils connurent leur pic de popularité dans les années 1980 et 1990 sous la forme de périodiques distribués
            sur média amovible (disquette), d'où leur nom.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/loadstar-1.jpeg">
            </div>
            <div class="item">
              <img src="/2/loadstar-2.jpeg" height="500px">
            </div>
          </div>
          <p>1984</p>
          <aside class="notes">
            - La caractéristique essentielle d'un diskmag, par distinction d'un magazine ASCII typique,
            est la présence d'un fichier exécutable destiné à tourner sur une plate-forme spécifique.
            - Ici le diskmag LOADSTAR pour Commodore 64 d'Amiga
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/big-blue-disk.jpeg">
          <p>1986</p>
          <aside class="notes">
            Cet exécutable lance un programme qui permet d'accéder aux différents articles.
            Un diskmag tend à mettre l'accent sur l'esthétique et propose une interface graphique dédiée,
            de la musique de fond et d'autres fonctionnalités utilisant la plate-forme pour laquelle il est codé.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/john-romero.png" />
          <p><b>John Romero - 1989</b></p>
          <aside class="notes">
            En 89 y'a un jeune gars de 22 ans, qui s'appelle John Romero, qui rejoint Softdisk.
            Il développe des jeux pour Apple II depuis le début des années 1980, c'est pas son premier rodéo.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/pyramids-of-egypt.gif" height="300px" />
              <p><b>1987 - Pyramids of Egypt</b></p>
            </div>
            <div class="item fragment">
              <img src="/2/dangerous-dave.png" height="300px" />
              <p><b>1988 - Dangerous Dave</b></p>
            </div>
          </div>
          <aside class="notes">
            Il développe des jeux pour Apple II depuis le début des années 1980, c'est pas son premier rodéo.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/gamers-edge-logo.png">
          <p><b>Gamer's Edge - 1990</b></p>
          <aside class="notes">
            En 1990, il prend l'initiative avec quelques employés de Softdisk de créer un diskmag
            dédié aux jeux video, sous le nom de Gamer's Edge.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/john-carmack.webp">
          <p><b>John Carmack - 1990</b></p>
          <aside class="notes">
            Parmis ces employés, il y a un certain John Carmack que peut-être vous connaissez.
            Il faudrait que je déborde de plusieurs heures pour vous présenter ce monsieur mais
            on a beaucoup de choses à dire, alors ça sera peut-être pour une prochaine fois.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/id-software-team.webp">
          <b>"Ideas From The Deep"</b>
          <aside class="notes">
            Ce groupe se désignant lui même sous le nom de "Ideas From The Deep" est composé de 5 personnes :
            - John Carmack (programmeur)
            - John Romero (programmeur)
            - Tom Hall (concepteur)
            - Adrian Carmack (artiste, pas du tout de la famille de John)
            - Jay Wilbur, le manager
          </aside>
        </section>

        <section>
          <!-- <video data-autoplay src="https://www.youtube.com/watch?v=1YWD6Y9FUuw&ab_channel=usgamernet"></video> -->
          <p><b>Dangerous Dave in Copyright Infringement</b></p>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/commander-keen.jpeg">
            </div>
            <div class="item">
              <img class="fragment m-b-0" src="/2/commander-keen-2.png" height="300px">
              <img class="fragment m-t-0" src="/2/commander-keen-3.png" height="300px">
            </div>
          </div>
        </section>

        <section>
          <img class="highlight-shadow" src="/2/id-software-logo.png" />
          <p><b>iD Software - 1er février 1991</b></p>
        </section>

        <section>
          https://www.vg247.com/how-a-super-mario-bros-3-pc-port-created-id-software
          https://en.wikipedia.org/wiki/Adaptive_tile_refresh
        </section>

        <section>
          <img class="r-stretch" src="/2/internet-scholastic.jpg">
          <aside class="notes">
            Le développement d'Internet à la fin des années 1990 a conduit à leur remplacement presque intégral
            par des publications en ligne, certaines se désignant toujours comme « diskmags »
            malgré l'absence de support physique.
          </aside>
        </section>

        <section>
          - de la création d'idSoftware,<br />
          - à la création de Quake 3 Arena,<br />
          - à la libération du code en open source en 2005.<br />
          - à la découverte de la fonction Q_rsqrt<br />
          <aside class="notes">
            Notre histoire commence en 1990.
            https://fr.wikipedia.org/wiki/Id_Software
          </aside>
        </section>

        <section>
          ...
        </section>

      </section>

      <!-- 3. La fonction -->
      <section data-background-image="/3/the-function.jpeg" data-transition="fade" class="scrim darkblue">
        <h2>3.<br />La fonction</h2>
      </section>
      <section data-background-image="/3/the-function.jpeg" class="blurred scrim darkblue">
        <section data-transition="fade">
          <div class="big">
            \[f(x) = \frac{1}{\sqrt{x}}\]
          </div>
          <aside class="notes">
            Cette fonction, elle ne fait qu'une seule chose : elle calcule l'inverse de la racine carrée d'un nombre.
          </aside>
        </section>

        <section data-transition="fade">
          <div style="margin-left: 15%;" class="big">
            <pre class="c clean">
              <code class="fragment" data-trim>
                <script type="text/template">
                  #include <math.h>
                </script>
              </code>
              <code data-trim>
                float y = 1 / sqrt(x);
              </code>
            </pre>
          </div>
          <aside class="notes">
            En C on l'écrirait comme ceci.

            On aurait pas besoin de coder une fonction de calcul de racine carrée,
            on la chopperait dans une lib standard, comme math.h.
          </aside>
        </section>

        <section data-transition="fade">
          <br />
          <div class="cv">
            <div class="item fragment">
              <pre class="c wide smaller clean">
                <code data-trim>
                  float Q_rsqrt( float number ) {
                    long i;
                    float x2, y;
                    const float threehalfs = 1.5F;
  
                    x2 = number * 0.5F;
                    y  = number;
                    i  = * ( long * ) &y;                        // evil floating point bit level hacking
                    i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                    y  = * ( float * ) &i;
                    y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                    // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed
  
                    return y;
                  }
                </code>
              </pre>
            </div>
            <div class="item fragment">
              <img class="abs right" src="/3/the-what.jpeg" />
            </div>
          </div>
          <aside class="notes">
            Mais dans le code source Quake, on ne retrouve pas cette fonction.
            Voici ce qu'on y trouve à la place.
          </aside>
        </section>

        <section data-transition="zoom">
          <code data-id="Q" class="title">Q</code>
          <code data-id="_" class="title">_</code>
          <code data-id="r" class="title">r</code>
          <code data-id="sqrt" class="title">sqrt</code>
          <br />
          <code class="bright">
            <span class="fragment">Quake</span>
            <span class="fragment">Reverse</span>
            <span class="fragment">Square Root</span>
          </code>
          <br />
          <div class="fragment">
            <br />
            <i>The Fast Inverse Square Root Algorithm</i>
          </div>
          <aside class="notes">
            Ou "Fast Inverse Square Root Algorithm"
          </aside>
        </section>

      </section>

      <!-- 4. Normaliser des vecteurs -->
      <section data-background-image="/4/blender.jpeg" data-transition="fade" class="scrim lightgrey">
        <h2>4.<br />Tu as peur ?<br />c'est normal</h2>
      </section>
      <section data-background-image="/4/blender.jpeg" class="blurred">

        <section>
          <img class="fragment r-stretch" src="/4/but-why.gif" />
          <aside class="notes">
            Tout ça c'est bien, mais pourquoi diable aurait-on besoin de calculer l'inverse de la racine carrée
            d'un nombre ?
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/4/minecraft-torch.jpeg" />
          <p class="smaller muted">Minecraft - Mojang Studios</p>
          <aside class="notes">
            Pour comprendre ça, il faut comprendre comment fonctionne un moteur de jeu,
            et en particulier la gestion de la lumière.
          </aside>
        </section>

        <section data-auto-animate>
          <img class="noshadow" src="/4/apple-2.png" />
          <aside class="notes">
            Pour simplifier, les objects dans un monde en 3D ne sont qu'un ensemble de surface, qui doivent reflèter
            la lumière chacune à leur manière.
          </aside>
        </section>

        <section data-auto-animate>
          <img class="noshadow" src="/4/apple-2.png" height="300px" />
          <img class="noshadow" src="/4/apple-1.png" />
        </section>

        <section data-auto-animate>
          <div class="fragment ch">
            <div class="item"><img data-id="1" class="noshadow" src="/4/tetes/alexo.png" /></div>
            <div class="item"><img data-id="2" class="noshadow" src="/4/tetes/fdu.png" /></div>
            <div class="item"><img data-id="3" class="noshadow" src="/4/tetes/jeremie.png" /></div>
            <div class="item"><img data-id="4" class="noshadow" src="/4/tetes/greg.png" /></div>
            <div class="item"><img data-id="5" class="noshadow" src="/4/tetes/erwann.png" /></div>
            <div class="item"><img data-id="6" class="noshadow" src="/4/tetes/lasouche.png" /></div>
          </div>
          <aside class="notes">
            Je vous propose d'illustrer ça avec un exemple.
            Prennons cette belle brochette de vainqueurs.
          </aside>
        </section>
        <section style="transform: scale(0.8);" data-transition="fade" data-auto-animate>
          <div class="ch">
            <div class="cv"><!-- 1st row -->
              <div class="item"></div>
              <div class="item"><img class="max-head" data-id="1" src="/4/cube-light/alexo_white.png" /></div>
              <div class="item"></div>
            </div>
            <div class="cv"><!-- 2nd row -->
              <div class="item"><img class="max-head" data-id="2" src="/4/cube-light/fdu_white.png" /></div>
              <div class="item"><img class="max-head" data-id="3" src="/4/cube-light/jeremie_white.png" /></div>
              <div class="item"><img class="max-head" data-id="4" src="/4/cube-light/greg_white.png" /></div>
            </div>
            <div class="cv"><!-- 3rd row -->
              <div class="item"></div>
              <div class="item"><img class="max-head" data-id="5" src="/4/cube-light/erwann_white.png" /></div>
              <div class="item"></div>
            </div>
            <div class="cv"><!-- 4th row -->
              <div class="item"></div>
              <div class="item"><img class="max-head" data-id="6" src="/4/cube-light/lasouche_white.png" /></div>
              <div class="item"></div>
            </div>
          </div>
          <aside class="notes">
            Admettons que je colle ces têtes ensemble pour en faire un magnifique cube
          </aside>
        </section>

        <section data-transition="fade">
          <div class="cube" id="three-animation"></div>
          <aside class="notes">
            Et que je le place dans un monde en 3D.
          </aside>
        </section>

        <section>
          <img class="highlight" src="/4/normal-vector.svg" />
          <h3>Deux étapes</h3>
          <br />
          <h4 class="fragment">1. Calcul d'un <span class="bright">vecteur normal</span> au plan</h4>
          <h4 class="fragment">2. <span class="bright">Normalisation</span> de ce vecteur</h4>
          <aside class="notes">
            Pour réaliser ce rendu, il y a entre-autre 2 étapes :
            - le calcul d'un vecteur normal au plan
            - la normalisation de ce vecteur
          </aside>
        </section>

        <section>
          <img src="/4/maths-stonks.jpeg" />
          <aside class="notes">
            Pour calculer la lumière qui va frapper le cube, il faut calculer la normale du plan.
            Mais qu'est-ce que la normale ?
            La on va faire un petit détour par les maths :)
          </aside>
        </section>

        <section data-transition="fade">
          <h4>1. Un <span class="bright">vecteur normal</span> à un plan</h4>
          <div class="ch">
            <div class="item-wide">
              <blockquote class="fragment">
                <q>
                  Un vecteur <strong>non nul</strong>
                  <br />de l'espace est <strong>normal</strong>
                  <br />à un plan P
                  <br />s'il est <strong>orthogonal</strong>
                  <br />à deux vecteurs <strong>non colinéaires</strong> de P
                </q>
              </blockquote>
            </div>
            <div class="item">
              <img class="noshadow" src="/4/pretend-to-be-normal.png" />
            </div>
          </div>
          <aside class="notes">
            Le calcul de l'angle d'incidence de la lumière sur un objet nécessite de calculer la normale à la surface
            Mais qu'est-ce que la normale ?
            (définition)
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/4/jerem-applati.png" />
          <aside class="notes">
            !!! BESOIN DU STYLET !!!
            Reprennons par exemple la face du cube qui est également la face de Jérémie.
            Ici, Jérémie qui est un plan, un bon plan même si j'ose le dire
            Un vecteur "normal" à Jérémie, est un vecteur perpendiculaire au plan.
          </aside>
        </section>

        <section>
          *
          animation ici avec 3 points qui définissent un plan,
          2 vecteurs non-colinéaires au plan,
          et calcul du vecteur normal au plan
          *
          <br />
          Trouver un vecteur normal à un plan, c'est pas compliqué.
          <br />
          https://web.ma.utexas.edu/users/m408m/Display12-5-4.shtml#:~:text=The%20normal%20to%20the%20plane,%C3%97(s%E2%88%92b).
        </section>

        <section>
          <h4>2. <span class="bright">Normalisation</span> du vecteur</h4>
          <img class="fragment highlight-shadow" src="/4/vector-mag-dir.svg" height="400px" />
          <aside class="notes">
            Normaliser des vecteurs est une opération très courante dans les moteurs de jeu.
            Cela permet de séparer :
            - la **direction** (vers où pointe-t-il)
            - de la **magnitude** (la taille)
            Voici un autre exemple pour illustrer ça :
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img class="highlight-shadow" src="/4/jerem-applati.png" />
            </div>
            <div class="item">
              <img class="highlight-shadow" src="/4/jerem-applati.png" />
            </div>
          </div>
          <aside class="notes">
            !!! BESOIN DU STYLET !!!
            Si je prend un vecteur d'une magnitude random, genre 4.9, mes calculs sont réalisés avec cette magnitude.
            Ce n'est pas ce qu'on veut
            On veut normaliser ce vecteur, c'est à dire le ramener à une magnitude de 1.
          </aside>
        </section>

        <section>
          <div class="game" id="game-container"></div>
          <aside class="notes">
            Admettons que je développe un petit jeu de course. Pour faire simple on va dire que :
            - on ne peut bouger que dans 8 directions
            - ma vitesse max est de 200 pixels par secondes
            - il n'y a pas d'accélération (ça veut dire que ma voiture va soit à 0, soit à VITESSE_MAX).

            Si j'appuie sur "haut", je vais en haut, à la vitesse de 200 pixels par secondes.
            Si j'appuie sur "droite", je vais à droite à 200 pixels par secondes.
            Mais si j'appuie simultanément sur haut et droite ? Je vais aller en haut à droite, à 400 pixels par
            secondes !
            Ca craint, ça veut dire que je vais plus vite en diagonale, ce qui est débile.

            Pour corriger ça, je vais avoir besoin de décorrélé la direction de la magnitude.
            Pour ça, je vais normaliser mon vecteur de direction, et le multiplier par ma vitesse max.
            Si v(x,y) = (1,1) et que ma vitesse max est de 200, alors je vais à 200 pixels par secondes en haut à
            droite,
            100pixels en haut, et 100 pixels à droite par seconde.
            Ainsi ma vitesse max ne dépend pas de la direction.
          </aside>
        </section>

        <section>
          <div>
            <h3>En 2D :</h3>
            <video data-autoplay src="/4/pythagore-1.mp4"></video>
          </div>
          <aside class="notes">
            Soit mon vecteur V en rose, il a une magnitude de M.
            On peut le décomposer en 2 vecteurs, Vx et Vy, qui sont les composantes de V selon les axes X et Y.
            Comment je peux trouver V, si je connais Vx et Vy à votre avis ?
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img data-fragment-index="2" class="fragment" src="/4/pythagoras.webp" height="600px" />
            </div>
            <div class="item cv">
              <div class="item">
                <img src="/4/vector-2D.png" height="300px" />
              </div>
              <div class="item">
                <div class="fragment">
                  <span class="vector">$V^{2}$</span> $ = $ <span class="x">$x^{2}$</span> $ + $ <span
                    class="y">$y^{2}$</span>
                </div>
                <br />
                <div class="fragment">
                  <span class="vector">$V$</span> $ = \sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}}}$
                </div>
              </div>
            </div>
          </div>
          <aside class="notes">
            Mais oui, grâce à Pythagore biensûr !
          </aside>
        </section>

        <section>
          <h3>En 3D :</h3>
          <video data-autoplay src="/4/pythagore-2.mp4"></video>
          <aside class="notes">
            Sauf que nous, on est en 3, donc comment ça se passe ?
            Eh bah c'est exactement la même chose, avec une composante supplémentaire
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <div class="item">
                <img src="/4/vector-3D.png" height="300px" />
              </div>
              <div class="item">
                <div class="fragment">
                  <span class="vector">$V^{2}$</span> $ = $ <span class="x">$x^{2}$</span> $ + $ <span
                    class="y">$y^{2}$</span> $ + $ <span class="z">$z^{2}$</span>
                </div>
                <br />
                <div class="fragment">
                  <span class="vector">$V$</span> $ = \sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} +
                  \textcolor{#DCBD87}{z^{2}}}$
                </div>
              </div>
            </div>
            <div class="item cv fragment">
              <img src="/4/pythagoras-glasses.png" height="500px" />
            </div>
          </div>
        </section>

        <section>
          <h3>Ce qu'on cherche à calculer alors :</h3>
          <p class="fragment">
            Soit <span class="vector">$V$</span>$($<span class="x">$x$</span>$,$<span class="y">$y$</span>$,$<span
              class="z">$z$</span>$)$ un vecteur de magnitude <span class="vector">$M$</span>
          </p>
          <p>
            <span class="fragment">
              <b>Normaliser</b> <span class="vector">$V$</span>, c'est trouver les composantes
              <br /><span class="x">$x_n$</span>, <span class="y">$y_n$</span> et <span class="z">$z_n$</span> d'un
              vecteur <span class="vector">$V_n$</span> de magnitude
              <span class="vector">$M_n = 1$</span></span>
          </p>
          <aside class="notes">
            Ce qu'on cherche à calculer alors :
            Soit V(x,y,z) un vecteur de magnitude M
            Pour normaliser le vecteur (M = 1), on cherche à calculer :
          </aside>
        </section>

        <section>
          <div class="cv">
            <div class="ch item">
              <div class="item">
                \[x_n = \frac{x}{M}\]
              </div>
              <div class="item">
                \[y_n = \frac{y}{M}\]
              </div>
              <div class="item">
                \[z_n = \frac{z}{M}\]
              </div>
            </div>
            <div class="ch item">
              <div class="item">
                \[x_n = \frac{x}{\sqrt{x^{2} + y^{2} + z^{2}}}\]
              </div>
              <div class="item">
                \[y_n = \frac{y}{\sqrt{x^{2} + y^{2} + z^{2}}}\]
              </div>
              <div class="item">
                \[z_n = \frac{z}{\sqrt{x^{2} + y^{2} + z^{2}}}\]
              </div>
            </div>
          </div>
        </section>

        <section>
          https://fabiensanglard.net/quake3/renderer.php
        </section>

        <section>
          <aside class="notes">
            Maintenant qu'on a vu à quoi sert cette fonction, on va pouvoir s'intéresser à son implémentation.
            Pour ça, on va d'abord s'armer de 2 prérequis :
            - la représentation binaire des nombres décimaux, dits "à virgule flottante"
            - et des petits rappels de maths concernant les logarithmes de base 2
            Ne vous inquiétez pas, ça va bien se passer :)
          </aside>
        </section>

      </section>

      <!-- 5. La représentation binaire des nombres à virgules flottantes -->
      <section data-background-image="/5/splash.jpg" data-transition="fade" class="scrim darkblue">
        <h2>5.</h2>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <h3>They see me floatin<br />They hatin</h3>
      </section>
      <section data-background-image="/5/splash.jpg" class="blurred">

        <section data-auto-animate>
          <div class="cv">
            <div class="item">
              <pre data-id="1" class="c wide smaller clean">
                <code data-trim data-line-numbers="1-4">
                  float Q_rsqrt( float number ) {
                    long i;
                    float x2, y;
                    const float threehalfs = 1.5F;
  
                    x2 = number * 0.5F;
                    y  = number;
                    i  = * ( long * ) &y;                        // evil floating point bit level hacking
                    i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                    y  = * ( float * ) &i;
                    y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                    // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed
  
                    return y;
                  }
                </code>
              </pre>
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <pre data-id="1" class="c smaller clean">
            <code data-trim data-line-numbers>
              float Q_rsqrt( float number ) {
                long i;
                float x2, y;
                const float threehalfs = 1.5F;
            </code>
          </pre>
          <div class="cv">
            <div class="item">
              <div class="fragment fade-in-then-semi-out">
                <code class="normal bold">number</code>, un <code class="type bold">float</code> dont on veut
                <br />la racine carrée inversée
              </div>
              <div class="fragment fade-in-then-semi-out">
                <code class="normal bold">i</code>, un <code class="type bold">long</code> sur <strong>32 bits</strong>
              </div>
              <div class="fragment fade-in-then-semi-out	">
                <code class="normal bold">x2</code> et <code class="normal bold">y</code>,
                deux <code class="type bold">float</code>, aussi sur <strong>32 bits</strong>
              </div>
              <div class="fragment">
                <code class="normal bold">threehalfs</code>, un <code class="type bold">const float</code>
                sur <strong>32 bits</strong>,
                <br />initialisé à <strong>1,5</strong>
              </div>
            </div>
          </div>
          <aside class="notes">
            Commençons par lire ces quelques lignes qui, j'en suis sûr, ne présentent pas particulièrement de
            difficulté...
            Enfin ça c'est pas si simple :p

            Déjà quelques questions émergent :
            - Pourquoi on déclare une constante pour 1,5 ?
            - Pourquoi threehalfs et pas threehalves, qui est l'orthographe correcte ?
            - Aucune idée 🤡
          </aside>
        </section>

        <!-- integer -->
        <section>
          <h3>long</h3>
          <h4><code class="normal">long32</code></h4>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant value"
              data-fragment-index="1">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="2">00000000 00000000 00000000 00000001</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="3">00000000 00000000 00000000 00000010</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="4">00000000 00000000 00000000 00000011</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="5">00000000 00000000 00000000 00000100</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="6">01111111 11111111 11111111 11111111</code>
            <code class="fragment instant value" data-fragment-index="7">11111111 11111111 11111111 11111111</code>
          </div>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant normal" data-fragment-index="1">0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="2">1</code>
            <code class="fragment current-visible instant normal" data-fragment-index="3">2</code>
            <code class="fragment current-visible instant normal" data-fragment-index="4">3</code>
            <code class="fragment current-visible instant normal" data-fragment-index="5">4</code>
            <code class="fragment current-visible instant normal" data-fragment-index="6">2147483647</code>
            <code class="fragment instant normal" data-fragment-index="7">-2147483647</code>
          </div>
          <aside class="notes">
            Un long représente un entier (positif ou négatif) sur 32 bits.
            Il peut donc prendre 2^32 valeurs différentes, de -2^31 à 2^31-1.
            le premier bit est le signe, et les 31 autres bits représentent la valeur.

            D'ailleurs, si vous voulez un moyen mnémotechnique simple pour vous souvenir de cette valeur,
            il vous suffit de mémoriser le nombre PI jusqu'à sa 1,867,996,689ème décimale :)

            The numeric string 2147483647 appears at the 1,867,996,680 decimal digit of Pi.
            3.14......86181221809936452346 2147483647 10527835665425671614...
          </aside>
        </section>

        <!-- float -->
        <section data-auto-animate>
          <h3>float</h3>
          <h4><code class="normal">float32</code></h4>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant value"
              data-fragment-index="1">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="2">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="3">00000000 00000000.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="4">00000000 00000001.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="5">00000000 00000010.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="6">00000000 00000011.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="7">00000000 00000100.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="8">00000000 00000100.10000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="9">00000000 00000100.01000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="10">00000000 00000100.00100000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="11">00000000 00000100.00010000 00000000</code>
            <code class="fragment instant value" data-fragment-index="12">11111111 11111111.00010000 00000000</code>
          </div>
          <br />
          <div class="r-stack">
            <img data-fragment-index="2" class="fragment current-visible abs-center-top" src="/5/thinking.png"
              height="400px" />
            <code class="fragment current-visible instant normal" data-fragment-index="1">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="2">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="3">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="4">1.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="5">2.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="6">3.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="7">4.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="8">4.5</code>
            <code class="fragment current-visible instant normal" data-fragment-index="9">4.25</code>
            <code class="fragment current-visible instant normal" data-fragment-index="10">4.125</code>
            <code class="fragment current-visible instant normal" data-fragment-index="11">4.0625</code>
            <code class="fragment instant normal" data-fragment-index="12">65536.0625</code>
            <img class="fragment current-visible abs-center" data-fragment-index="13" src="/5/this-is-the-worst.gif"
              height="400px" />
          </div>
          <div class="r-stack">

          </div>
          <aside class="notes">
            Un float représente un nombre décimal, ou "nombre à virgule flottante" sur 32 bits.
            On va revenir sur ce terme.

            Question à l'assemblée : comment vous représenteriez un tel nombre, si vous aviez ces 32 bits ?
            -> Oui, on peut mettre un point au milieu, et séparer les bits en deux parties.
            La partie gauche pour la partie entière, et la partie droite pour la partie décimale.

            On aurait donc la partie gauche qui sont des puissance de 2, et la partie droite qui sont des puissance de 2
            négatives : des demi, quart, huitième, 16ème, etc.

            Mais on a un problème : en faisant cela, on réduit drastiquement le maximum représentable !
            On ne peut peut plus stoquer que des nombres compris entre
            -2^16 et 2^16-1, soit 65536 valeurs différentes.

            Ce qui est très cringe !
          </aside>
        </section>

        <section>
          <br />
          <h3>Du coup, comment on fait ?</h3>
          <br />
          <div class="ch">
            <div class="item fragment">
              On double la taille d'un <code class="type bold">float</code> ?
              <br />
              <code class="normal bold">float32 -> float64</code>
            </div>
            <div class="item fragment">
              Mais en fait <code class="normal bold">float64</code> ça existe déjà,
              <br />
              c'est un <code class="normal bold">double</code> 😅
            </div>
          </div>
          <div class="ch">
            <div class="item fragment">
              <br />
              Donc on créer un nouveau <code class="normal bold">float128</code> ?
            </div>
            <div class="item fragment">
              <img src="/5/ca-fait-beaucoup.gif" height="250px" />
            </div>
          </div>
          <aside class="notes">
            On est d'accord que ce n'est pas acceptable.
            On pourrait augmenter la taille de notre float, mais ça créer d'autres problèmes :
            - ça prend plus de place en mémoire, le moindre float genre "3.2" prend 64 bits au lieu de 32, le double de
            place,
            - il aurait fallut créer un float128 pour stocker des nombres à plus grande précision (ce que sont les
            double),
            ce qui aurait posé des problèmes d'architectures des processeurs, qui sont conçu pour manipuler des nombres
            sur 32 ou 64 bits.
          </aside>
        </section>

        <section>
          <video class="r-stretch" data-autoplay src="/5/homer-cest-nul.webm"></video>
        </section>

        <section>
          <h4>Heureusement il y a ...</h4>
          <div class="r-stack">
            <img class="fragment current-visible instant" src="/5/findus.png" />
            <div class="fragment instant">
              <h3>La norme</h3>
              <h1 class="highlight-gold">IEEE 754</h1>
            </div>
          </div>
          <aside class="notes">
            Heureusement il y'a Fiiiiiinnnnnduuuuu ... la norme IEEE 754
            C'est ce que se sont dit des gens pour ça que des gens plutôt malins, des gens de l'IEEE
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/5/IEEE-logo.png" height="400px" />
          <p class="fragment"><strong class="small">Institute of Electrical and Electronics Engineers</strong></p>
          <aside class="notes">
            De son nom complet, **l'Institute of Electrical and Electronics Engineers**,
            c'est une organisation internationale qui élabore des normes dans divers domaines, dont l'informatique.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item-wide fragment">
              <img class="noshadow" src="/5/aeei-logo.png" width="100%" />
              <p class="small">
                <strong>AIEE</strong>
                <br />American Institute of Electrical Engineers
                <br /><strong>1884</strong>
              </p>
            </div>
            <div class="item fragment">
              <br /><br />
              <h1>+</h1>
            </div>
            <div class="item-wide fragment">
              <img class="noshadow" src="/5/ire-logo.png" />
              <p class="small">
                <strong>IRE</strong>
                <br />Institute of Radio Engineers
                <br /><strong>1912</strong>
              </p>
            </div>
          </div>
          <aside class="notes">
            Elle fut fondée en 1963 suite à la fusion de deux instituts américains :
            - l'AIEE : L'American Institute of Electrical Engineers
            - l'IRE : L'Institute of Radio Engineers
          </aside>
        </section>

        <section>
          <h3>IEEE 754</h3>
          <h4><q>The IEEE Standard for<br /><span class="bright">Floating-Point Arithmetic</span></q></h4>
          <br />
          <p class="fragment">
            Fondée sur deux notions :
          <ol>
            <li class="fragment"><strong data-id="1">la notation scientifique 🧑‍🔬</strong></li>
            <li class="fragment"><strong>le système binaire 0️⃣1️⃣</strong></li>
          </ol>
          </p>
        </section>

        <section>
          <h4>Rappel sur la notation dite "scientifique" des nombres <span class="bright">en base 10</span> :</h4>
          <div class="big">
            <span data-fragment-index="1" class="fragment ieee-mantissa">$4,36$</span>
            <span data-fragment-index="3" class="fragment ieee-exponent">$\times 10^{2}$</span>
          </div>
          <br />
          <div class="ch bold">
            <div data-fragment-index="2" class="item fragment">
              Un nombre décimal <span class="ieee-mantissa">$n$</span> <br />tel que :
              <br />
              $1 \leq$ <span class="ieee-mantissa">$n$</span> $&lt; 10$
            </div>
            <div data-fragment-index="4" class="item fragment">
              une <span class="ieee-exponent">puissance</span> entière<br />de <span class="ieee-exponent">$10$</span>
            </div>
          </div>
          <aside class="notes">
            Comprend 2 parties :
            - un nombre décimal, positif ou négatif, dont la valeur absolue est comprise entre 1 inclus et 10 exclus
          </aside>
        </section>

        <section>
          <h4>En binaire, on passe d'une « colonne » à une autre en multipliant ou en divisant par
            <span class="bright">une puissance de 2</span> :
          </h4>
          <p data-fragment-index="1" class="fragment">Exemple avec $170$</p>
          <div class="r-stack">
            <div data-fragment-index="3" class="ch fragment">
              <div class="item"><code>1</code><br /><span data-fragment-index="4"
                  class="fragment base-2-7">$2^{7}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="5" class="fragment">$2^{6}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="6"
                  class="fragment base-2-5">$2^{5}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="7" class="fragment">$2^{4}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="8"
                  class="fragment base-2-3">$2^{3}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="9" class="fragment">$2^{2}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="10"
                  class="fragment base-2-1">$2^{1}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="11" class="fragment">$2^{0}$</span></div>
            </div>
          </div>
          <br />
          <div class="ch">
            <div data-fragment-index="4" class="fragment item"><span class="base-2-7">$128$</span></div>
            <div data-fragment-index="5" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="6" class="fragment item"><span class="base-2-5">$+$ $32$</span></div>
            <div data-fragment-index="7" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="8" class="fragment item"><span class="base-2-3">$+$ $8$</span></div>
            <div data-fragment-index="9" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="10" class="fragment item"><span class="base-2-1">$+$ $2$</span></div>
            <div data-fragment-index="11" class="fragment item"><span>$+$ $0$</span></div>
          </div>
          <div class="fragment">
            $= 170$
          </div>
          <aside class="notes">
            En binaire, on passe d'une « colonne » à une autre en multipliant ou en divisant par une puissance de 2.
            Exemple avec 170.
          </aside>
        </section>

        <!-- Notation scientifique binaire -->
        <section>
          <h4>Application de la notation scientifique <br /><span class="bright">en base 2</span> :</h4>
          <div class="ch">
            <div class="item fragment">
              $3$ en binaire <code class="value">11</code>&nbsp;:
              <br />
              <span class="ieee-mantissa">$1,1$</span><span class="ieee-exponent">$\times 2^1$</span>
            </div>
            <div class="item fragment">
              $0,75$ en binaire <code class="value">0,11</code>&nbsp;:
              <br />
              <span class="ieee-mantissa">$1.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
            </div>
          </div>
          <br />
          <div class="ch">
            <div class="item fragment">
              Un nombre décimal <span class="ieee-mantissa">$n$</span> <br />tel que :
              <br />
              $1 \leq$ <span class="ieee-mantissa">$n$</span> $&lt; 2$
            </div>
            <div class="item fragment">
              une <span class="ieee-exponent bold">puissance</span> entière<br />de <span
                class="ieee-exponent">$2$</span>
            </div>
          </div>
          <aside class="notes">
            On peut donc représenter des nombres binaire avec cette notation scientifique de la même manière qu'en base
            10.
            La base a changée (on est passé de 10 à 2), mais le reste fonctionne de la même manière.
            Important : la mantisse est comprise entre 1 inclus et 10 (donc 2) exclus; 1 ≤ _n_ &lt; 2, sa
            -> sa partie entière est donc toujours 1
          </aside>
        </section>

        <!-- Sign-bit, exponent & mantissa -->
        <section>
          <div>✨ Un <code>float</code> selon la norme <strong>IEEE 754</strong> ✨</div>
          <br />
          <div class="cv">
            <div class="item">
              <span data-fragment-index="3" class="fragment bold ieee-exponent ieee-padded">exponent</span>
            </div>
            <div class="item">
              <div class="r-stack">
                <div data-fragment-index="1" class="fragment current-visible instant">
                  <code class="value">00000000 00000000 00000000 00000000</code>
                </div>
                <div data-fragment-index="2" class="fragment current-visible instant">
                  <code class="ieee-sign">0</code> <code>00000000</code> <code>00000000000000000000000</code>
                </div>
                <div data-fragment-index="3" class="fragment current-visible instant">
                  <code class="ieee-sign">0</code> <code class="ieee-exponent ieee-padded">00000000</code>
                  <code>00000000000000000000000</code>
                </div>
                <div data-fragment-index="4" class="fragment instant">
                  <code class="ieee-sign">0</code> <code class="ieee-exponent ieee-padded">00000000</code> <code
                    class="ieee-mantissa">00000000000000000000000</code>
                </div>
              </div>
            </div>
            <div class="item">
              <div class="ch">
                <div data-fragment-index="2" class="item fragment">
                  <span class="bold ieee-sign">sign bit</span>
                </div>
                <div class="item"><!----></div>
                <div data-fragment-index="4" class="item fragment">
                  <span class="bold ieee-mantissa">mantissa</span>
                </div>
              </div>
            </div>
          </div>
          <div data-fragment-index="1" class="fragment fade-in-then-semi-out instant"><strong>32 bits</strong></div>
        </section>

        <!-- Explications détaillées de la normalisation -->
        <section>
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <code class="ieee-sign">&nbsp;Sign bit&nbsp;</code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <code class="ieee-exponent">&nbsp;Exponent&nbsp;</code>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <code class="ieee-mantissa">&nbsp;Mantissa&nbsp;</code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <code><span class="ieee-sign">1</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000000</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="5" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000001</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="6" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000010</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="7" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000011</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="8" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="9" class="fragment current-visible instant">
              <span class="ieee-exponent ieee-exponent-range bold"><code>[0 255]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="10" class="fragment current-visible instant">
              <span class="ieee-exponent ieee-exponent-range bold"><code>[-127 128]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="11" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="12" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="13" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="15" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2²³-1]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="16" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="17" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="18" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">1.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="19" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">1.11111111111111111111111</span></code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span class="ieee-sign">$-$</span> $x$
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{E}$</span>
            </div>
            <div data-fragment-index="5" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{1}$</span>
            </div>
            <div data-fragment-index="6" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{2}$</span>
            </div>
            <div data-fragment-index="7" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{3}$</span>
            </div>
            <div data-fragment-index="8" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="9" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="10" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="11" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4-127}$</span>
            </div>
            <div data-fragment-index="12" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{131-127}$</span>
            </div>
            <div data-fragment-index="13" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$M$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="15" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$M$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="16" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$\frac{M}{2^{23}}$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="17" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="18" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$1,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="19" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$1,11$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
          </div>
          <aside class="notes">
            Les derniers 23 bits sont ce qu'on appelle la mantisse, du latin "mantissa" :
            signifiant "surplus" (en nombre, en poids, en monnaie…), augmentation, supplément, reste, ou familièrement
            "rabiot"
            Cela nous donne un nombre compris entre 0 et 2^23 -1. Ce n'est pas ce qu'on veut.

            Nous, on veut un nombre entre 1 et 1,9999 (2 exclus)
            On pourrait mettre une virgule après le premier chiffre, mais ça serait du gâchis.
            Pourquoi ça ?
          </aside>
        </section>

        <!-- En binaire, le premier digit est toujours '1' en notation scientifique -->
        <section data-transition="fade">
          <table>
            <thead>
              <tr>
                <th>Decimal</th>
                <th>Binary</th>
                <th>Scientific base 2</th>
              </tr>
            </thead>
            <tbody>
              <tr data-fragment-index="1" class="fragment">
                <td>$3$</td>
                <td><code class="value">11</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^1$</span>
                    </div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^1$</span></div>
                  </div>
                </td>
              </tr>
              <tr data-fragment-index="2" class="fragment">
                <td>$0.75$</td>
                <td><code class="value">0.11</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
                    </div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
                    </div>
                  </div>
                </td>
              </tr>
              <tr data-fragment-index="3" class="fragment">
                <td>$4.625$</td>
                <td><code class="value">101.101</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.00101$</span><span class="ieee-exponent">$\times
                        2^{2}$</span></div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.00101$</span><span class="ieee-exponent">$\times 2^{2}$</span>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <br />
          <p class="fragment bright">ℹ️ Le premier chiffre est <span class="underline">toujours</span> $1$</p>
          <aside class="notes">
            En notation scientifique, le premier digit d'un nombre est par définition différent de 0.
            Hors en base 2, il n'existe qu'un chiffre différent de 0 : 1 !
            Si on sait que le 1er chiffre sera toujours 1, cela ne sert à rien de le stocker.
          </aside>
        </section>

        <!-- Suite et fin explications -->
        <section data-auto-animate>
          <div data-fragment-index="5" class="fragment instant">
            <h3 class="highlight-gold">IEEE 754</h3>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.11111111111111111111111</span></code>
            </div>
            <div data-fragment-index="5" class="fragment instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.11111111111111111111111</span></code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="bright">$1$</span><span class="ieee-mantissa">$,00$</span>
              <span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $1$<span class="ieee-mantissa">$,11$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="5" data-id="1" class="fragment medium">
              <span class="ieee-sign">$+ ou -$</span> <span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span>
              <span class="ieee-exponent">$\times 2^{E-127}$</span>
            </div>
          </div>
          <div data-fragment-index="6" class="fragment instant">
            <img src="/5/nice.gif" />
          </div>
          <aside class="notes">
            En divisant par 2^23, on passe d'un nombre compris entre 0 et 2^23 -1 à un nombre compris entre 0 et 1
            En ajoutant un '1' arbitraire à notre nombre,
            on passe d'un nombre compris entre 0 et 1 à un nombre compris entre 1 et 2.
          </aside>
        </section>

        <section data-auto-animate>
          <div class="medium">
            <h4>Cas nominal</h4>
            <div data-id="1">
              <span class="ieee-sign">$+ ou -$</span> <span class="ieee-mantissa">$(1 +\frac{M}{2^{23}})$</span>
              <span class="ieee-exponent">$\times 2^{E-127}$</span>
            </div>
          </div>
          <aside class="notes">
            Dans notre cas, on sait que le signe sera toujours positif, donc on peut l'ignorer.
          </aside>
        </section>

        <section>
          <div class="medium">
            \[f(x) = \frac{1}{\sqrt{-x}}\]
          </div>
          <div>
            <img class="fragment" src="/5/big-nono.jpeg" />
          </div>
          <aside class="notes">
            En effet, si on en vient à calculer la racine carrée d'un nombre négatif, il s'est passé un truc pas net !
          </aside>
        </section>

        <section>
          <div class="medium">
            <h4>Dans notre cas</h4>
            $y = $<span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span> <span class="ieee-exponent">$\times
              2^{E-127}$</span>
          </div>
          <br />
          <div class="fragment">
            <h5>Représentation binaire</h5>
            <div>
              <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">10010010000000000000000</span></code>
            </div>
            <div>
              <code><span class="ieee-exponent">$E \times 2^{23}$</span> $+$ <span class="ieee-mantissa">$M$</span></code>
            </div>
          </div>
        </section>


      </section>

      <!-- 6. Log2, Log2(1+x) et autre filouteries -->
      <section data-background-image="/6/logarithms-book.jpeg" data-transition="fade" class="scrim grey">
        <h2>6.</h2>
        <h2>Filouteries logarithmiques</h2>
        <img class="noshadow abs-center-bottom" src="/6/wojak-mask.png" height="300px" />
      </section>
      <section data-background-image="/6/logarithms-book.jpeg" class="blurred">
        <section>
          <img class="fragment" src="/5/log2-undertaker.jpg" />
          <aside class="notes">
            Et maintenant, pour aucune raison apparente, on va prendre le logarithme de notre nombre.
          </aside>
        </section>

        <section>
          <div class="math fragment fade-in-then-semi-out">
            $y =$ <span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span> <span class="ieee-exponent">$\times
              2^{E-127}$</span>
          </div>
          <hr class="fragment" />
          <div class="text-left">
            <div class="math fragment fade-in-then-semi-out" style="margin-left: 140px;">
              $log_2(y) = log_2($<span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span>
              <span class="ieee-exponent">$\times 2^{E-127}$</span>$)$
            </div>
            <div class="math fragment fade-in-then-semi-out" style="margin-left: 300px;">
              $= log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
              $+ log_2($<span class="ieee-exponent">$2^{E-127}$</span>$)$
            </div>
            <div class="r-stack">
              <div class="math fragment current-visible" style="margin-left: 300px;">
                $= log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
                $+$ <span class="ieee-exponent">$E-127$</span>
              </div>
              <div class="math fragment" style="margin-left: 300px;">
                $=$ <span class="still-log">$log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$</span>
                $+$ <span class="ieee-exponent">$E-127$</span>
              </div>
            </div>
          </div>
          <img class="fragment wtf-cat" src="/6/wtf-cat.jpeg" />
          <aside class="notes">
            Pourquoi on fait ça ? Mais parce qu'on peut virer l'exposant !
            Mais du coup maintenant on est bloqué avec un gros logarithme en plein milieu...
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item fragment">
              <img class="noshadow" src="/6/wojak-dumb.png" />
              <b>moi</b>
            </div>
            <div class="item fragment">
              <img class="noshadow" src="/6/wojak-smart.png" />
              <b>les devs de Quake 3</b>
            </div>
          </div>
          <aside class="notes">
            La différence entre moi et les gens qui ont développé Quake c'est qu'ils avaient une astuce pour
            se débarraser du logarithme restant
          </aside>
        </section>

        <section data-auto-animate>
          <video class="motion-canvas" data-id="1" data-autoplay data-src="/6/test.mp4"></video>
        </section>
        <section data-auto-animate>
          <video class="motion-canvas" data-id="1" data-autoplay data-src="/6/test-2.mp4"></video>
        </section>

        <section>
          <div class="text-left" style="margin-left: 15%;">
            <div class="math fragment fade-in-then-semi-out">
              $log_2(y) = log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
              $+$ <span class="ieee-exponent">$E-127$</span>
            </div>
            <div class="math math-pad-log fragment fade-in-then-semi-out">
              $= $ <span class="ieee-mantissa">$\frac{M}{2^{23}}$</span>
              <span class="mu">$+ \mu$ </span>$+$ <span class="ieee-exponent">$E-127$</span>
            </div>
            <div class="r-stack math-pad-log-stack">
              <div class="math fragment current-visible">
                $= \frac{1}{2^{23}}$
                $($<span class="binary-rep-inv"><span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                    class="ieee-mantissa">$M$</span></span>$)$
                $- 127$ <span class="mu">$+ \mu$</span>
              </div>
              <div class="math fragment instant">
                $= \frac{1}{2^{23}}$
                $($<span class="binary-rep"><span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                    class="ieee-mantissa">$M$</span></span>$)$
                $- 127$ <span class="mu">$+ \mu$</span>
              </div>
            </div>
          </div>
          <div class="fragment">
            <img src="/6/binary-rep.jpeg" />
          </div>
          <aside class="notes">
            On peut remplacer alors !
          </aside>
        </section>

        <section>
          <h3>Et alors c'est incroyable !</h3>
          <h4 class="fragment">Car cela signifie que :</h4>
          <br />
          <div class="fragment">
            <div class="medium">
              $log_2(y) \approx$ <span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                class="ieee-mantissa">$M$</span>
            </div>
            <b class="fragment bright medium">sa propre représentation binaire !</b>
            <br />
            <br />
            <div class="fragment muted">(scale de $1/2^{23}$ et shifté de $-127 + \mu$<br />mais tranquille)</div>
          </div>
          <aside class="notes">
            Résumons ce qu'on a fait :
            - on a pris le log de base 2 de notre expression (notre float normalisé IEEE 754)
            - dans ce log, on a retrouvé la représentation binaire de notre float
            -> celà signifie que : la représentation binaire de notre float est (presque) égale à son log2
          </aside>
        </section>

      </section>

      <!-- 7. Le langage C en sueur -->
      <section data-background-image="/7/splash.png" data-transition="fade" class="scrim">
        <h2 style="padding-bottom: 400px;">7.<br />Le langage<br />C en sueur</h2>
        <img class="noshadow c-logo" src="/7/c-logo.png" />
      </section>
      <section data-background-image="/7/splash.png" class="blurred scrim darkgrey">
        <section data-transition="fade">
          <pre data-id="1" class="c wide smaller clean">
            <code data-trim data-line-numbers="8,10">
              float Q_rsqrt( float number ) {
                long i;
                float x2, y;
                const float threehalfs = 1.5F;

                x2 = number * 0.5F;
                y  = number;
                i  = * ( long * ) &y;                        // evil floating point bit level hacking
                i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                y  = * ( float * ) &i;
                y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed

                return y;
              }
            </code>
          </pre>
          <aside class="notes">
            Le commentaire "evil floating point bit level hacking" ne nous aide pas trop sur ce coup là...
          </aside>
        </section>

        <section data-auto-animate>
          <code class="bold normal medium" data-id="1">
            i = * ( <code class="type">long</code> * ) &y
          </code>
          <img class="fragment" src="/7/cringe-kid.webp" height="400px" />
          <aside class="notes">
            Si vous avez déjà fait du C ou du C++, vous êtes sûrement familiers avec le concept de pointeur.
          </aside>
        </section>

        <section>
          <code class="bold normal medium" data-id="1">
            i = ( <code class="type">long</code> ) y
          </code>
          <br />
          <br />
          <q class="fragment">
            <span class="fragment">La <b class="emphas">valeur</b> de la variable <b class="type">float</b> <code
                class="normal">y</code></span>
            <br />
            <span class="fragment">est <b class="emphas">castée</b> en tant que <b class="type">long</b></span>
            <br />
            <span class="fragment">et <b class="emphas">assignée</b> à la variable <b class="type">long</b> <code
                class="normal">i</code></span>
          </q>
          <aside class="notes">
            On va le déchiffrer ensemble.
            Certains auront déjà compris qu'il s'agit d'un cast.
            En C, si on veut cast un float en long, on peut faire ça
          </aside>
        </section>

        <section>
          <code class="bold normal medium">
            i = <span data-fragment-index="5" class="fragment">*</span> <span data-fragment-index="3" class="fragment">( <code class="type">long</code>
          * )</span> <span data-fragment-index="1" class="fragment">&y</span>
          </code>
          <br />
          <br />
          <ol>
            <li data-fragment-index="2" class="fragment fade-in-then-semi-out">
              On ne vas pas lire la <b class="emphas">valeur</b> de <code class="normal">y</code>
              <br />mais son <b class="address">adresse</b> mémoire (c'est un pointeur)
            </li>
            <li data-fragment-index="4" class="fragment fade-in-then-semi-out">
              On cast pour faire croire à C que :
              <br />
              "la valeur à <b class="address">l'adresse</b> mémoire de <code class="normal">y</code> est un <code
                class="type">long</code>"
            </li>
            <li data-fragment-index="6" class="fragment fade-in-then-semi-out">
              On lit la <b class="emphas">valeur</b> présente à cette <b class="address">adresse</b>, comme si c'était
              un <code class="type">long</code>
            </li>
          </ol>
          <aside class="notes">
            Mais ici, ce n'est pas tout à fait ce qu'il se passe.
            Si vous avez déjà fait du C ou du C++, vous êtes sûrement familiers avec le concept de pointeurs et
            d'adresses.
            On va lire la ligne de droite à gauche pour mieux comprendre :
            - on récupère l'adresse mémoire de y : c'est une référence, un pointeur vers un float
            - si on s'arrête là, C nous engueule avec un type mismatch !
            - i est un long, pas un float *
            - on dit à C : "tqt, je sais qu'à cette adresse, c'est un pointeur vers un long"
            - si on s'arrête là, C nous engueule encore avec un type mismatch !
            - i est un long, pas un long *
            - on a besoin de cette dernière étoile pour déréférencer le pointeur (on récupère la valeur vers laquelle il
            pointe)
            - un pointeur déréférencé d'un long, est un long, on est bon !
          </aside>
        </section>

        <section>
          <h3>C Symbol Table</h3>
          <div class="r-stack">
            <table data-fragment-index="1" class="fragment current-visible fade-up">
              <tr>
                <th>Symbol</th>
                <th>Address</th>
                <th>Type</th>
              </tr>
              <tr>
                <td><code class="normal">i</code></td>
                <td><code class="address">0xBF6CC739</code></td>
                <td><code class="type">int</code></td>
              </tr>
              <tr>
                <td><code class="normal">x2</code></td>
                <td><code class="address">0xEA3FC4F7</code></td>
                <td><code class="type">float</code></td>
              </tr>
              <tr>
                <td><code class="bold normal">y</code></td>
                <td><code class="bold address">0x0B00B135</code></td>
                <td><code class="bold type">float</code></td>
              </tr>
              <tr>
                <td><code class="normal">threehalfs</code></td>
                <td><code class="address">0x5EE7F9A1</code></td>
                <td><code class="type">float</code></td>
              </tr>
            </table>
            <table data-fragment-index="3" class="fragment instant">
              <tr>
                <th>Symbol</th>
                <th>Address</th>
                <th>Type</th>
              </tr>
              <tr>
                <td><code class="normal">i</code></td>
                <td><code class="address">0xBF6CC739</code></td>
                <td><code class="type">int</code></td>
              </tr>
              <tr>
                <td><code class="normal">x2</code></td>
                <td><code class="address">0xEA3FC4F7</code></td>
                <td><code class="type">float</code></td>
              </tr>
              <tr>
                <td><code class="bold normal">y</code></td>
                <td><code class="bold address">0x0B00B135</code></td>
                <td><code class="bold bright">int</code></td>
              </tr>
              <tr>
                <td><code class="normal">threehalfs</code></td>
                <td><code class="address">0x5EE7F9A1</code></td>
                <td><code class="type">float</code></td>
              </tr>
            </table>
          </div>
          <div data-fragment-index="1" class="fragment fade-left symbol-table-arrow">&lt;</div>
          <img class="fragment abs-center" src="/7/magic-shia.gif" />
        </section>

        <section>
          <h3>On résume :</h3>
          <div>
            <code class="bold normal medium">
              i = * ( <code class="type">long</code> * ) &y
            </code>
          </div>
          <br />
          <table class="fragment small">
            <tr>
              <th>Symbole</th>
              <th>Type</th>
              <th>Valeur</th>
              <th>Bits</th>
            </tr>
            <tr class="fragment">
              <td><code class="normal">y</code></td>
              <td><code class="type">float</code></td>
              <td><code>4,36</code></td>
              <td><code
                  class="small"><span class="ieee-sign">0</span><span class="ieee-exponent">10000001</span><span class="ieee-mantissa">00101000...</span></code>
              </td>
            </tr>
            <tr class="fragment">
              <td><code class="normal">i</code></td>
              <td><code class="type">long</code></td>
              <td><code>1083441152</code></td>
              <td><code class="small value">01000000100101000...</code></td>
            </tr>
          </table>
          <aside class="notes">
            Donc maintenant, que fait C lorqu'on lui demande la valeur de y ?
            Il va lire les bits de `y` comme si c'était un long et les assigner à `i` !
          </aside>
        </section>

        <section data-auto-animate>
          <div class="ch">
            <div data-fragment-index="1" class="item fragment">
            <br/>
              <img class="highlight-shadow" src="/7/cordons-bleus.png" />
            </div>
            <div data-fragment-index="3" class="item fragment">
              <img class="highlight-shadow" src="/7/ps5-box.webp" />
            </div>
          </div>
          <img data-fragment-index="2" class="fragment highlight-shadow price-tag" src="/7/price-tag.png" />
        </section>
        <section data-auto-animate>
          <div class="ch">
            <div class="item">
            <br/>
              <img class="highlight-shadow" src="/7/cordons-bleus.png" />
            </div>
            <div class="item">
              <img class="highlight-shadow" src="/7/ps5-box.webp" />
            </div>
          </div>
          <img class="highlight-shadow price-tag-2" src="/7/price-tag.png" />
        </section>

        <section>
          <img src="/7/cashier.jpeg" height="600px" />
          <img class="fragment highlight-shadow c-logo-cashier" src="/7/c-logo.png" />
        </section>

        <section>
          <img class="noshadow" src="/7/pranked.png" height="600px" />
        </section>

      </section>

      <!-- 8. What the fuck -->
      <section data-background-image="/8/wtf-jackie.jpeg" data-transition="fade" class="scrim lightgrey">
        <h2>8.<br />What the f*ck</h2>
      </section>
      <section data-background-image="/8/wtf-jackie.jpeg" class="blurred scrim grey">
        <section data-transition="fade">
          <pre data-id="1" class="c wide smaller clean">
            <code data-trim data-line-numbers="9">
              float Q_rsqrt( float number ) {
                long i;
                float x2, y;
                const float threehalfs = 1.5F;

                x2 = number * 0.5F;
                y  = number;
                i  = * ( long * ) &y;                        // evil floating point bit level hacking
                i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                y  = * ( float * ) &i;
                y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed

                return y;
              }
            </code>
          </pre>
          <aside class="notes">
            On arrive à cette fameuse ligne...
          </aside>
        </section>

        <section data-transition="fade" data-auto-animate>
          <div data-id="1">
            <code data-id="1" data-trim class="normal regular">
            <span class="opaque">i = <code class="value">0x5f3759df</code> - (</span>
            <span>i >> <code class="value">1</code></span>
            <span class="opaque">);</span>
            </code>
          </div>
          <img class="fragment" src="/8/wtf-6.jpeg" height="400px" />
          <aside class="notes">
            Là, c'est même plus C le problème, c'est carrément des hiéroglyphes
            C'est quoi ce nombre hexa complètement arbitraire ?
            Pourquoi on fait un i deux fois plus grands que 1 ?
            C'est ce qu'on va voir ici !
          </aside>
        </section>

        <section data-auto-animate>
          <div data-id="1">
            <code data-trim class="normal regular">
              <span class="semi-trans">i = <code class="value">0x5f3759df</code> - (</span>
            <span>i >> <code class="value">1</code></span>
            <span class="semi-trans">);</span>
            </code>
          </div>
          <br />
          <h3 class="fragment">Bitshifting !</h3>
          <br />
          <div class="ch medium">
            <div class="item">
              <pre class="js fragment fade-in-then-semi-out"><code>long i = 6 // 110</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i &lt;&lt; 1 // 1100, 12</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i >> 1 // 11, 3</code></pre>
            </div>
            <div class="item">
              <pre class="js fragment fade-in-then-semi-out"><code>long i = 7 // 111</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i &lt;&lt; 1 // 1110, 14</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i >> 1 // 11, 3</code></pre>
            </div>
          </div>
          <aside class="notes">
            Bitshift un nombre vers la gauche revient à le multiplier par 2
            Vers la droite, à le diviser par 2
            Et oui, le bitshift arrondi à l'entier inférieur, c'est fâcheux, mais ça a le mérite d'être extrèmement plus
            rapide que de faire une division classique.
          </aside>
        </section>

        <section>
          On a dit que dans i, on avait stocké log2(y)

          log(1/sqrt(y)) = log(y^{-1/2}) = -1/2 * log(y)

          donc log(1/sqrt(y)) = - (i >> 1)

          on a maintenant dans i : une approximation de log(1/sqrt(y))
          repasser les bits de i dans y nous donne une approximation de 1/sqrt(y)
        </section>

      </section>

      <!-- 9. Ce bon vieux Newton -->
      <section data-background-image="/9/newton-wallpaper.jpeg" data-transition="fade">
        <br />
        <h2>9.<br />Ce bon vieux Newton</h2>
        <aside class="notes">
          Et pour finir cet algorithme, on va parler d'une petite technique de coquin
          qui nous vient de ce bon vieux Newton.
        </aside>
      </section>
      <section data-background-image="/9/newton-wallpaper.jpeg" class="blurred">
        <section>
          <div class="ch">
            <div class="item">
              <img src="/9/isaac-newton-vertical.jpeg">
            </div>
            <div class="item fragment">
              <img src="/9/manoir-woolsthorpe.jpeg">
              <p>1642</p>
            </div>
          </div>
          <aside class="notes">
            Isaac Newton est né le 25 décembre 1642 au Manoir Woolsthorpe, dans le Lincolnshire, en Royaume d'Angleterre
          </aside>
        </section>

        <section>
          <img src="/9/paysans-bretons.jpeg" />
          <aside class="notes">
            Ses parents sont fermiers tous les deux, et son père meurt 3 mois avant sa naissance
            suite à un manque de chance.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/9/boy-with-toast.jpeg">
            </div>
            <div class="item fragment">
              <img src="/9/tartine.jpeg">
              <img class="fragment" src="/9/pere-castor-nrv.jpeg" height="250px">
            </div>
          </div>
          <aside class="notes">
            Un jour qu'il a 5 ans, sa mère lui fait son petit déj et lui dit :
            "Tu veux pas une tartine ? Pour étaler ta vie batard ?"
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/9/isaac-newton.jpeg" />
          <div data-fragment-index="1" class="newton-quote-1 small fragment">
            <q class="bold">Invents gravity,<br />cannot attract anyone</q><br />- un internaute
          </div>
          <div data-fragment-index="2" class="newton-quote-2 small fragment">
            <q class="bold">C'est trop</q><br />- Isaac Newton
          </div>
          <img data-fragment-index="2" class="highlight-shadow newtons-tear fragment" src="/9/tear.png" />
          <aside class="notes">
            Nan je rigole mais on a plus trop le temps, ça sera pour un autre talk
          </aside>
        </section>

        <section>
          <img class="abs-center god-rays" src="/9/god-rays.png" />
          <div>
            <h2 class="highlight-gold">La méthode de Newton</h2>
            <h5>(ou méthode de Newton-Raphson)</h5>
            <h2 class="fragment grow">1669</h2>
          </div>
          <aside class="notes">
            Ce qui nous intéresse, c'est la méthode "dite" de Newton, publiée en 1669, ou Newton-Raphson
            (un autre mathématicien anglais du 16ème siècle) qui en publia une version simplifiée en 1690
          </aside>
        </section>

        <section>
          <h3>Cette méthode c'est quoi ?</h3>
          <div class="r-stack">
            <blockquote class="fragment current-visible fade-in-then-out">
              <q>Une méthode <b>itérative</b> de recherche de zéro d'une fonction, qui consiste à construire une suite
                de nombres
                réels par une <b>méthode géométrique</b>, et à montrer que cette suite <b>converge vers le zéro</b> de
                la fonction</q>
            </blockquote>
            <div class="fragment current-visible big">
              \[f(x)\]
            </div>
            <div class="fragment big">
              \[f(x) = 0\]
            </div>
          </div>
          <aside class="notes">
            Pour faire simple : voilà.
            Comme on comprend rien, voici une animation pour illustrer ça.
          </aside>
        </section>

        <section>
          *l'animation en question*
          <aside class="notes">
            On part d'un point x0, on calcule la valeur de la fonction en ce point, et on trace la tangente à la courbe
            en ce point.
            On regarde ensuite où cette tangente coupe l'axe des abscisses, et on recommence.
            On obtient une suite de points qui converge vers le zéro de la fonction.
          </aside>
        </section>

        <section>
          <h3>Ok mais qui s'en fout ?</h3>
        </section>

      </section>

      <!-- 10. Conclusion -->
      <section data-background-image="/10/quake-3-sarge.webp" data-transition="fade">
        <h2>10.<br />Conclusion</h2>
        <aside class="notes">
          Pour conclure :
          - qu'est ce qu'on a appris
          - finalement, qui est à l'origine de ce bout de code ? (l'investigation)
          - gain de temps ? (3 à 4 fois plus rapide)
          - les jeux qui utilisent le même engine (Star Wars Jedi Outcast, etc)
          - https://www.reddit.com/r/gaming/comments/vznc9v/do_you_remember_id_tech_3_engine_games_aka_quake/
        </aside>
      </section>
      <section data-background-image="/10/quake-3-sarge.webp" class="blurred">
        <section>
          Concluons
        </section>
      </section>

      <!-- 11. Fin -->
      <section data-background-image="/1/cake-aux-olives.jpeg" data-transition="fade">
        <h1>Merci !</h1>
        <strong class="shadow">Distribution de paracétamol<br />à la pause</strong>
      </section>
    </div> <!-- /slides -->
  </div> <!-- /reveal -->

  <!-- Scripts -->
  <script type="module" src="/phaser.js"></script>
  <script type="module" src="/three.js"></script>
  <script type="module" src="/main.js"></script>
</body>

</html>