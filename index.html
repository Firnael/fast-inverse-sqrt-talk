<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/ico" href="favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fast Inverse Square Root - The Talk</title>
</head>

<body>
  <div class="reveal">
    <div class="slides">

      <!-- 1. Introdution -->
      <section data-background-image="/1/splash.jpg" data-transition="fade" class="scrim grey">
        <h1 class="main-title r-fit-text">The (In)glorious<br />Function</h1>
        <aside class="notes">
          Bonjour à tous, bienvenue à tous, je m'appelle Audren Burlot, et je suis honoré d'être devant vous aujou'd'hui
          pour vous présenter ce talk qui s'intitule "The Inglorious Function".

          Aujourd'hui je vais vous raconter l'histoire d'un bout de code.
          Une fonction bien connue, dont vous avez certainement déjà entendu parler.
          Une fonction trouvée il y a 20 dans le code source d'un jeu sorti il y a 24 ans.
          Une fonction qui m'a cassé le cerveau.
        </aside>
      </section>

      <section data-background-image="/1/splash.jpg" class="blurred">
        <section>
          <div class="cv">
            <div class="item ch">
              <div class="item r-stack">
                <img class="fragment current-visible fade-up" src="/1/cake-aux-olives.jpeg" />
                <img class="fragment fade-down highlight-shadow" src="/1/quake-3-logo.png" />
              </div>
              <div class="item highlight-gold fade-down fragment bigger" style="margin-top: 20px;">
                \[\sqrt{x}\]
              </div>
              <div class="item fragment fade-down">
                <img class="highlight-shadow" src="/1/vector-art.png" />
              </div>
            </div>
            <div class="item ch">
              <div class="item fragment fade-up">
                <img class="highlight-shadow" src="/1/fractal.jpeg" />
              </div>
              <div class="item fragment fade-up">
                <img class="highlight-shadow" src="/1/newton-head.png" />
              </div>
              <div class="item fragment fade-up" style="padding-bottom: 20px;">
                <img class="highlight-shadow" src="/1/black-magic.png" />
              </div>
            </div>
          </div>
          <aside class="notes">
            Dans ce talk nous allons donc parler :
            - de Quake, mais pas celui aux olives, le jeu Quake 3 sorti en 1999 développé par id Software
            - de racine carré
            - de normalisation de vecteurs
            - de logarithme de base 2
            - de ce bon vieux Newton
            - et un peu de magie noire
            Mais avant de vous parler de code, il faut qu'on revienne un peu en arrière, et qu'on voyage outre-Atlantique
          </aside>
        </section>

      </section>

      <!-- 2. Storytime -->
      <section data-background-image="/2/pere-castor.jpeg" data-transition="fade" class="scrim sepia">
        <h1 class="highlight-gold">Storytime !</h1>
      </section>
      <section data-background-image="/2/pere-castor.jpeg" class="blurred">

        <section>
          <div class="r-stack">
            <img src="/2/shreveport.jpeg" />
            <img class="fragment" src="/2/shreveport-map.jpg" />
          </div>
          <p><b>Shreveport - Louisiane</b></p>
          <aside class="notes">
            Notre histoire commence au début des années 80, à Shreveport en Louisiane, USA...
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/softdisk-offices.jpeg" />
          <aside class="notes">
            ...avec une entreprise qui se nomme Softdisk Publishing.
          </aside>
        </section>
        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/softdisk-publishing-logo.webp" />
              <b>1981</b>
              <div class="fragment">
                <img src="/2/diskmag-1981.webp" />
              </div>
            </div>
            <div class="item fragment">
              <br />
              <img src="/2/harbinger.webp" />
            </div>
          </div>
          <aside class="notes">
            D'abord un club d'informatique, puis une entreprise dès 1981, Softdisk est une boite
            d'édition de magazines sur disquette divers et variés à parution mensuelle.
            A droite le premier diskmag de la boite : The Harbinger, pour Apple II.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/floppy-disks.jpeg">
          <p><b>"Diskmags"</b></p>
          <aside class="notes">
            Un magazine sur disquette, "diskmag" en anglais et même "magazette" en français,
            est un magazine souvent amateur distribué sous format électronique afin d'être lu sur un ordinateur.
            Ils connurent leur pic de popularité dans les années 1980 et 1990 sous la forme de périodiques distribués
            sur média amovible (disquette), d'où leur nom.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/john-romero.jpeg" />
          <p><b>John Romero - 1989</b></p>
          <aside class="notes">
            En 89 y'a un jeune gars de 22 ans, qui s'appelle John Romero, qui rejoint Softdisk.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/pyramids-of-egypt.gif" height="300px" />
              <p><b>Pyramids of Egypt<br />1987</b></p>
            </div>
            <div class="item fragment">
              <img src="/2/dangerous-dave.png" height="300px" />
              <p><b>Dangerous Dave<br />1988</b></p>
            </div>
          </div>
          <aside class="notes">
            Il développe des jeux pour Apple II depuis le début des années 1980, qu'il publie déjà dans des diskmags.
            A droite "Dangerous Dave", un jeu de plateforme qui selon Romero était une tentative de cloner Super Mario
            sur PC.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/gamers-edge-logo.png">
          <p><b>Gamer's Edge - 1990</b></p>
          <aside class="notes">
            En 1990, il prend l'initiative avec quelques employés de Softdisk de créer un diskmag
            dédié aux jeux video sur PC, sous le nom de Gamer's Edge.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/john-carmack.webp">
          <p><b>John Carmack - 1990</b></p>
          <aside class="notes">
            Parmis ces employés, il y a un certain John Carmack que peut-être vous connaissez.
            Il faudrait que je déborde de plusieurs heures pour vous présenter ce monsieur mais
            on a beaucoup de choses à dire, alors ça sera peut-être pour une prochaine fois.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/gamers-edge-interface.gif" />
              <img src="/2/catacomb.png" height="300px" />
            </div>
            <div class="item">
              <br />
              <img src="/2/diskmag-hovertank.jpeg" />
            </div>
          </div>
          <aside class="notes">
            Bon, ils font des jeux, ça se passe bien, y'a un rythme de parution bi-mensuel, qui passe à mensuel,
            puis tous les 2 mois, une idée de Romero pour augmenter la qualité des jeux.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/internet-scholastic.jpg">
          <aside class="notes">
            Softdisk, et le concept de diskmags, c'est en train de tourner court
            avec l'arrivée d'internet dans les foyers au début des années 90.
            John Romero se dit qu'il est temps de passer à autre chose, et cherche une porte de sortie.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img class="highlight-shadow" src="/2/macintosh.png" height="400px" />
              <p><b>Macintosh & IBM PC<br />1984</b></p>
            </div>
            <div class="item"><img class="highlight-shadow" src="/2/ibm-pc.png" /></div>
          </div>
          <aside class="notes">
            Ce qu'il faut savoir, c'est qu'à l'époque le hardware des PC (Apple II, IBM PC), s'il est adapté pour
            executer des tâches dites de bureautique, et offre une plus grande variété de logiciel,
            n'est vraiment pas adapté pour jouer à des jeux vidéos,
            contrairement à des machines comme l'Amiga ou le Commodore 64, ou l'Atari ST.
          </aside>
        </section>

        <section data-auto-animate>
          <video data-autoplay loop muted src="/2/dangerous-dave.mov"></video>
          <aside class="notes">
            Une des choses qui étaient carrément impossible à faire sur PC, c'était de faire des side-scroller.
          </aside>
        </section>

        <section data-auto-animate>
          <div class="ch">
            <div class="item">
              <br />
              <video data-autoplay loop muted src="/2/dangerous-dave.mov"></video>
              <p><b>Dangerous Dave<br />PC - 1988</b></p>
            </div>
            <div class="item">
              <video data-autoplay loop muted src="/2/smb-nes.mov"></video>
              <p><b>Super Mario Bros.<br />NES - 1985</b></p>
            </div>
          </div>
          <aside class="notes">
            Dites vous qu'on est en 1990, et que Super Mario Bros est sorti en 1985 sur NES.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <br />
              <br />
              <img src="/2/carmack-coding.jpeg" />
            </div>
            <div class="item fragment">
              <img src="/2/dangerous-dave-in-copyright.webp" height="600px" />
            </div>
          </div>
          <aside class="notes">
            Sauf qu'un jour y'a Carmack qui se pointe et qui montre à Romero un prototype de Dangerous Dave,
            qu'il nomme pour rigoler "Dangerous Dave in Copyright Infringement".
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <video data-autoplay loop muted src="/2/dangerous-dave-copyright.mov" height="600px"></video>
            <img class="fragment" src="/2/romero-coding.webp" height="500px" />
          </div>
          <p><b>1990</b></p>
          <aside class="notes">
            C'est un side-scroller parfaitement jouable sur PC, qui vole les sprites de SMB3.
            Romero est choqué, il comprend qu'ils ont entre les mains une technologie qui sera leur ticket de sortie.
            La technique employée s'appelle "L'Adaptive Tile Refresh"
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/id-software-team.webp">
          <b>"Ideas From The Deep"</b>
          <aside class="notes">
            Ce groupe se désignant lui même sous le nom de "Ideas From The Deep" est composé de 5 personnes :
            - John Carmack (programmeur)
            - John Romero (programmeur)
            - Tom Hall (concepteur)
            - Adrian Carmack (artiste, pas du tout de la famille de John)
            - Jay Wilbur, le manager
          </aside>
        </section>

        <section>
          <img src="/2/smb3-poc.jpeg" />
          <p><b>Prototype de SMB3 sur PC - 1990</b></p>
          <aside class="notes">
            Sachant qu'ils avaient potentiellement de l'or entre les mains, ils ont bricolé un prototype
            de Super Mario Bros 3 sur PC, pour montrer à Nintendo ce qu'ils étaient capables de faire.
            Ils ont envoyé le prototype à Nintendo, qui a refusé de les rencontrer.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/2/commander-keen.jpeg">
            </div>
            <div class="item">
              <img class="fragment m-b-0" src="/2/commander-keen-2.png" height="300px">
              <img class="fragment m-t-0" src="/2/commander-keen-gameplay.gif" height="300px">
            </div>
          </div>
          <aside class="notes">
            Ils ont donc décidé de créer leur propre jeu de plateforme, et c'est comme ça qu'est né Commander Keen.
            A la suite de quoi, leurs obligations contractuelles avec Softdisk prennent fin, et ils peuvent Enfin
            se lancer sur leur propre projet.
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/2/id-software-logo.png" />
          <p><b>iD Software - 1er février 1991</b></p>
        </section>

        <section>
          <video data-autoplay loop muted src="/2/raycast-maze.webm" height="600px"></video>
          <aside class="notes">
            Carmack avait déjà commencé à bidouiller et optimiser le code pour faire des jeux en 3D,
            même si le hardware des PCs sue à grosses gouttes.
            Ici vous avez le fameux screensaver de Windows 95 qui est un clin d'oeil à ce type de jeux du début des
            année 90.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item fragment">
              <img src="/2/hovertank-3d.png" />
              <p><b>Hovertank-3D</b></p>
            </div>
            <div class="item fragment">
              <br />
              <img src="/2/catacomb-3d.png" height="300px" />
              <p><b>Catacomb-3D</b></p>
            </div>
          </div>
          <p><b>1991</b></p>
          <aside class="notes">
            Parmis ceux-ci deux qui ont été développés par Id Software pour Softdisk en 1991 :
            - Hovertank 3D
            - Catacomb-3D
            qu'on peut considérer comme les tous premiers vrais FPS de l'histoire
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/wolfenstein-3d.png" />
          <p><b>Wolfenstein 3D - 1992</b></p>
          <aside class="notes">
            Wolfenstein 3D en 1992, où il faut buter des nazis dans un chateau,
            qui rapporte au studio 100 000$ d'avance, et 100 000$ de royalties le premier mois,
            ce qui met le studio très très bien
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <img class=" current-visible" src="/2/doom.avif" />
            <img class="fragment" src="/2/doom-1993.jpeg" />
          </div>
          <p><b>Doom - 1993</b></p>
          <aside class="notes">
            Doom, c'est 15 millions de téléchargements
          </aside>
        </section>

        <section>
          <img src="/2/doom-talk.jpeg" height="500px" />
          <p class="small muted">https://www.youtube.com/watch?v=sNapL2anR3E</p>
          <aside class="notes">
            Dont Doom, qui est un monument du jeu vidéo et mérite un talk à part entière,
            d'ailleurs ça a été fait, cf. le talk de Xavier-Frédéric Moulet du Breizhcamp 2022.
          </aside>
        </section>

        <section>
          <img src="/2/doom-2.webp" />
          <p><b>Doom 2 - 1994</b></p>
          <aside class="notes">
            Un record battu par Doom 2 d'ailleurs,
            si bien qu'en 1995, id Software totalise près de 16 millions de dollars de revenus.
            Id Software commence à vendre des licenses pour son moteur de jeu, et des dizaines de "doom-like" sortent.
            L'id Tech 1, on "Doom Engine"
          </aside>
        </section>

        <section>
          <img src="/2/quake1.jpeg" />
          <p><b>Quake - 1996</b></p>
          <aside class="notes">
            Après 18 mois de développement intense pour John Carmack,
            id Software réitéra son exploit en sortant Quake,
            qui, en plus d’être un des premiers jeux entièrement en 3D,
            apportait un code réseau basé sur une architecture client serveur très souple.
            L'id Tech 2, ou "Quake Engine"
            C'est notamment le jeu qui a popularisé le rocket jump , et démocratisé le online deathmatch
          </aside>
        </section>

        <section>
          <img src="/2/quake2.jpg" />
          <p><b>Quake II - 1997</b></p>
        </section>

        <section>
          <video data-autoplay loop data-src="/2/quake3-gameplay.mp4" height="500px"></video>
          <p><b><span class="highlight-gold">Quake III Arena</span><br />1999</b></p>
          <aside class="notes">
            Et enfin celui qui nous intéresse, Quake III Arena, en 1999, et son moteur...
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <div>
              <img src="/2/id-tech-3.webp" height="500px" />
              <p><b>id Tech 3</b></p>
            </div>
            <img class="fragment" style="margin-left: 10%;" src="/2/boxart-007-auf.webp" height="600px" />
            <img class="fragment" style="margin-left: 25%;" src="/2/boxart-moh.jpeg" height="600px" />
            <img class="fragment" style="margin-left: 40%;" src="/2/boxart-sw-jo.jpeg" height="600px" />
            <img class="fragment" style="margin-left: 55%;" src="/2/boxart-cod.webp" height="600px" />
          </div>
          <aside class="notes">
            ...l'iD Tech 3 et son legacy sont légions, parmis ceux-ci quelques jeux que vous connaissez peut-être :
            - 007 Espion de mes couilles en 2001
            - Medal of Honor : Débarquement Allié en 2002
            - SW: JK II en 2002 (et JW: JA l'année suivante)
            - et le premier Call of Duty en 2003
          </aside>
        </section>

        <section>
          <video data-autoplay loop muted src="/2/quakecon-2005.webm" height="500px"></video>
          <p><b>QuakeCon 2005</b></p>
          <aside class="notes">
            Lors de la Quake-con 2005 à Dallas au Texas,
            entre autres annonces juteuses comme la sortie de Quake 4,
            John Carmack annonce...
          </aside>
        </section>

        <section>
          <img src="/2/quake3-sources.png" />
          <aside class="notes">
            ...que le code source de Quake 3 sera libéré sous licence GPL.
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/2/years-later.jpg" />
          <aside class="notes">
            Fast forward en 2021
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/2/doomer-wojak.png" />
          <aside class="notes">
            Il y a à peu près 2 ans, peut-être un mardi soir, je traine sur le PC, il est environ 2h du
            mat, et au lieu d'aller me coucher comme ferait n'importe qui de censé, j'ouvre Youtube.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item"><img src="/2/chef-michel.jpeg" /></div>
            <div class="fragment item"><img src="/2/mew-glitch-youtube.jpeg" /></div>
          </div>
          <div class="ch">
            <div class="fragment item"><img src="/2/drunk-frodo-youtube.jpeg" /></div>
            <div class="fragment item"><img src="/2/ps1-boot-youtube.jpeg" /></div>
          </div>
          <aside class="notes">
            Je scroll mes recommendations alors forcément, je regarde comme faire un butterchicken avec le Chef Michel,
            etc.
          </aside>
        </section>

        <section data-auto-animate>
          <img class="fragment grow" src="/2/fsqrt-youtube.png" />
          <aside class="notes">
            Puis, je fini par tomber sur ça : "Fast Inverse Square Root - A Quake III Algorithm"
            Je me dis, est-ce bien l'heure de regarder 20 min de vidéo d'un gars qui parle d'un algorithme en C écrit
            il y a plus de 20 ans ? Et je clique.
          </aside>
        </section>

        <section data-auto-animate>
          <img src="/2/fsqrt-youtube.png" />
          <br />
          <video data-autoplay loop muted class="item" data-src="/2/monkey-brain.mp4" height="400px" />
          <aside class="notes">
            Bon, il était un peu tard, dans ma tête c'était comme ça
          </aside>
        </section>

        <section data-auto-animate>
          <div class="r-stack">
            <img src="/2/quake-3-map.webp" />
            <img class="fragment" src="/2/wojak-normal.webp" />
            <img class="fragment" src="/2/wojak-bave.png" />
            <img class="fragment" src="/2/wojak-stupid.jpeg" />
            <img class="fragment" src="/2/wojak-no-head.jpeg" />
            <img class="fragment" src="/2/wojak-blackhole.jpg" />
          </div>
          <aside class="notes">
            La vidéo parle d'une méthode d'optimisation obscure du rendu 3D de Quake 3,
            ça parle de calcul de réfraction de la lumière.
            Progressivement mon cerveau de résorbe sur lui-même pour former un trou noir.
          </aside>
        </section>

        <section>
          <img src="/2/wojak-sleeping.jpg" />
          <aside class="notes">
            À la fin de la vidéo, j'éteinds mon PC, et je vais me coucher.
            Je me suis demandé, est-ce que je serais capable d'expliquer ce que j'ai vu à quelqu'un d'autre ?
          </aside>
        </section>

        <section>
          <img src="/2/cat-newspaper.webp" />
          <aside class="notes">
            Le lendemain matin je suis en train de lire le journal comme ça en buvant mon café et je repense à cette vidéo.
            Frustré je me dit "si je fais un talk dessus, ça va me forcer à comprendre tout ce qu'il se passe"
          </aside>
        </section>

      </section>

      <!-- 4. À l'intérieur du moteur -->
      <section data-background-image="/4/blender.jpeg" data-transition="fade" class="scrim lightgrey">
        <h2 class="highlight-gold">À l'intérieur du moteur</h2>
      </section>
      <section data-background-image="/4/blender.jpeg" class="blurred">

        <section>
          <img class="r-stretch" src="/4/minecraft-torch.jpeg" />
          <p class="smaller muted">Minecraft - Mojang Studios</p>
          <aside class="notes">
            Pour comprendre ce bout de code, il faut comprendre comment fonctionne un moteur de jeu,
            et en particulier la gestion de la lumière.
          </aside>
        </section>

        <section data-auto-animate>
          <img class="noshadow" src="/4/apple-1.png" />
          <aside class="notes">
            Pour simplifier, les objects dans un monde en 3D ne sont qu'un ensemble de surface, qui doivent reflèter
            la lumière chacune à leur manière.
          </aside>
        </section>

        <section data-transition="fade">
          <div class="cube" id="three-animation"></div>
          <aside class="notes">
            Imaginons ce carré. 
            Mais en fait c'est pas un carré c'est un cube. 
            Il est tout noir, car dans ma scène, je n'ai aucune lumière.
            Si j'allume la lumière dite "ambiante", le cube apparaitra de la même couleur sur chaque face.
            Lorsqu'on vient appliquer une lumière dite "directionnelle" à ce cube, on s'aperçoit que 
            chaque face apparait d'une couleur différentes en fonction de l'angle 
          </aside>
        </section>

        <section>
          <img class="highlight" src="/4/normal-vector.svg" />
          <h3>Deux étapes</h3>
          <br />
          <h4 class="fragment">1. Calcul d'un <span class="bright">vecteur normal</span> au plan</h4>
          <h4 class="fragment">2. <span class="bright">Normalisation</span> de ce vecteur</h4>
          <aside class="notes">
            Pour réaliser ce rendu, il y a entre-autre 2 étapes :
            - le calcul d'un vecteur normal au plan
            - la normalisation de ce vecteur
          </aside>
        </section>

        <section>
          <img src="/4/maths-stonks.jpeg" />
          <aside class="notes">
            Pour calculer la lumière qui va frapper le cube, il faut calculer la normale du plan.
            Mais qu'est-ce que la normale ?
            La on va faire un petit détour par les maths :)
          </aside>
        </section>

        <section data-transition="fade">
          <h4>1. Un <span class="bright">vecteur normal</span> à un plan</h4>
          <div class="ch">
            <div class="item-wide">
              <blockquote class="fragment">
                <q>
                  Un vecteur <strong>non nul</strong>
                  <br />de l'espace est <strong>normal</strong>
                  <br />à un plan P
                  <br />s'il est <strong>orthogonal</strong>
                  <br />à deux vecteurs <strong>non colinéaires</strong> de P
                </q>
              </blockquote>
            </div>
            <div class="item">
              <img class="noshadow" src="/4/pretend-to-be-normal.png" />
            </div>
          </div>
          <aside class="notes">
            Le calcul de l'angle d'incidence de la lumière sur un objet nécessite de calculer la normale à la surface
            Mais qu'est-ce que la normale ?
            (définition)
          </aside>
        </section>

        <section>
          <img class="highlight" src="/4/produit-vectoriel.png" />
          <aside class="notes">
            Trouver un vecteur normal à un plan, c'est pas compliqué.
            C'est un produit vectoriel entre 2 vecteurs non-colinéaires au plan.
            Comme on peut le voir avec ce schéma très mal détouré, la production s'excuse pour la gêne occasionnée
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/4/jerem-applati.png" height="400px" style="margin-top: 200px;" />
          <aside class="notes">
            !!! BESOIN DU STYLET !!!
            Reprenons par exemple la face du cube qui est également la face de Jérémie.
            Ici, Jérémie qui est un plan, un bon plan même si j'ose le dire
            Un vecteur "normal" à Jérémie, est un vecteur perpendiculaire au plan.
          </aside>
        </section>

        <section>
          <h4>2. <span class="bright">Normalisation</span> du vecteur</h4>
          <blockquote>
            <p class="fragment">
              "Prenez un vecteur, <br />calculez sa longueur et <br /><b>divisez chaque composante du vecteur par cette
                longueur.</b>
            </p>
            <p class="fragment">
              Ce nouveau vecteur obtenu aura <br /><b>une longueur de 1</b>. <br />Cette technique est appelée
              <b>normalisation</b>."
            </p>
          </blockquote>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <video data-autoplay loop muted src="/4/normalize.mp4"></video>
            </div>
            <div class="item fragment">
              <p>Permet de différencier la <b class="emphas">direction</b> de la <b class="emphas">longueur</b></p>
              <img class="highlight-shadow" src="/4/vector-mag-dir.svg" width="400px" />
            </div>
          </div>
          <aside class="notes">
            - Attention : un vecteur normal n'est pas forcément normalisé.
            - Un vecteur normalisé est un vecteur (la longueur) dont la magnitude est de 1.
            - Cela permet de séparer :
            la **direction** (vers où pointe-t-il)
            de la **magnitude** (sa longueur)
          </aside>
        </section>

        <section>
          <h4>Pourquoi c'est important ?</h4>
          <br />
          <br />
          <div class="ch fragment">
            <div class="item">
              <img class="highlight-shadow" src="/4/jerem-applati.png" />
            </div>
            <div class="item">
              <img class="highlight-shadow" src="/4/jerem-applati.png" />
            </div>
          </div>
          <aside class="notes">
            !!! BESOIN DU STYLET !!!
            Si je prend un vecteur d'une magnitude random, genre 4.9, mes calculs sont réalisés avec cette magnitude.
            Ce n'est pas ce qu'on veut, on doit normaliser ce vecteur, c'est à dire le ramener à une magnitude de 1.
          </aside>
        </section>

        <section>
          <h4>Un exemple</h4>
          <h3 class="highlight-gold">Car Game JS 3000</h3>
          <div class="ch">
            <div data-fragment-index="2" class="item fragment">
              <img class="highlight-shadow" src="/4/eight-directions.png" />
            </div>
            <div data-fragment-index="1" class="item fragment">
              <img class="highlight-shadow" src="/car-game/car.png" />
            </div>
            <div data-fragment-index="3" class="item fragment">
              <br />
              <ul class="small">
                <li>Vitesse max :<br />200px / seconde</li>
                <br />
                <li>Pas d'accél :<br />0 à 200 instant</li>
              </ul>
            </div>
          </div>
          <aside class="notes">
            Pour vous donner un exemple visuel j'ai fait un mini-jeu de voiture.
            Votre voiture peut aller dans 8 directions, et a une vitesse max de 200 pixels par secondes.
          </aside>
        </section>

        <section>
          <div class="game" id="game-container"></div>
          <aside class="notes">
            - Si j'appuie sur "haut", je vais en haut, à la vitesse de 200 pixels par secondes.
            Si j'appuie sur "droite", je vais à droite à 200 pixels par secondes.
            Mais si j'appuie simultanément sur haut et droite ? Je vais aller en haut à droite, à 400 pixels par
            secondes !
            Ca craint, ça veut dire que je vais plus vite en diagonale, ce qui est débile.
            - Pour corriger ça, je vais avoir besoin de décorrélé la direction de la magnitude.
            Pour ça, je vais normaliser mon vecteur de direction, et le multiplier par ma vitesse max.
            Si v(x,y) = (1,1) et que ma vitesse max est de 200, alors je vais à 200 pixels par secondes en haut à
            droite,
            100pixels en haut, et 100 pixels à droite par seconde.
            Ainsi ma vitesse max ne dépend pas de la direction.
          </aside>
        </section>

        <section>
          <h4>Ce qui ne va pas :</h4>
          <div class="fragment">
            <pre class="js">
              <code data-trim data-line-numbers="3|4-7|8-11|13-14">
              /** la_voiture_vroum_vroum.js*/

              const VITESSE_MAX = 200;
              var direction = {
                x: 1, // j'appuie sur ➡️
                y: 1, // j'appuie sur ⬆️
              }
              var vitesse = {
                x: direction.x * VITESSE_MAX;
                y: direction.y * VITESSE_MAX;
              }
              
              console.log(vitesse); // { x: 200, y: 200 }
              console.log(vitesse.x + vitesse.y); // 400
              </code>
            </pre>
          </div>
          <aside class="notes">
            Ici, pour corriger mon jeu de voiture, j'ai besoin de normaliser mon vecteur de direction.
          </aside>
        </section>

        <section>
          <h4>Comment je corrige ça ?</h4>
          <h4 class="highlight-gold fragment">Je normalise mon vecteur direction</h4>
          <div class="fragment">
            <pre class="js">
              <code data-trim data-line-numbers="1-4|6-7|9-12|14-15">
              const direction = {
                x: 1, // j'appuie sur ➡️
                y: 1, // j'appuie sur ⬆️
              }

              direction.normalize();  // 👀
              console.log(direction); // { x: 0.5, y: 0.5 }

              var vitesse = {
                x: direction.x * VITESSE_MAX;
                y: direction.y * VITESSE_MAX;
              }
              
              console.log(vitesse); // { x: 100, y: 100 }
              console.log(vitesse.x + vitesse.y); // 200
              </code>
            </pre>
          </div>
          <aside class="notes">
            Ici, pour corriger mon jeu de voiture, j'ai besoin de normaliser mon vecteur de direction.
          </aside>
        </section>

        <section>
          <pre style="margin-left: 10%; font-size: 1.5em;" class="js clean">
            <code data-trim>
              direction.normalize();
            </code>
            </pre>
          <h1>?</h1>
        </section>

        <section>
          <div>
            <h3>En 2D :</h3>
            <video data-autoplay src="/4/pythagore-1.mp4"></video>
          </div>
          <aside class="notes">
            Soit mon vecteur V en rose, de magnitude (longueur) M.
            On peut le décomposer en 2 vecteurs, Vx et Vy, qui sont les composantes de V selon les axes X et Y.
            Comment je peux trouver V, si je connais Vx et Vy à votre avis ?
          </aside>
        </section>

        <section data-transition="fade">
          <div class="ch">
            <div class="item">
              <img data-fragment-index="2" class="fragment" src="/4/pythagoras.webp" height="600px" />
            </div>
            <div class="item cv">
              <div class="item">
                <img src="/4/vector-2D.png" height="300px" />
              </div>
              <div class="item">
                <div class="fragment">
                  <span class="vector">$V^{2}$</span> $ = $ <span class="x">$x^{2}$</span> $ + $ <span
                    class="y">$y^{2}$</span>
                </div>
                <br />
                <div class="fragment">
                  <span class="vector">$V$</span> $ = \sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}}}$
                </div>
              </div>
            </div>
          </div>
          <aside class="notes">
            Mais oui, grâce à Pythagore biensûr !
          </aside>
        </section>

        <section data-transition="fade">
          <h3>En 3D :</h3>
          <video data-autoplay src="/4/pythagore-2.mp4"></video>
          <aside class="notes">
            Sauf que nous, on est en 3, donc comment ça se passe ?
            Eh bah c'est exactement la même chose, avec une composante supplémentaire
          </aside>
        </section>

        <section data-transition="fade">
          <div class="ch">
            <div class="item">
              <div class="item">
                <img src="/4/vector-3D.png" height="300px" />
              </div>
              <div class="item">
                <div class="fragment">
                  <span class="vector">$V^{2}$</span> $ = $ <span class="x">$x^{2}$</span> $ + $ <span
                    class="y">$y^{2}$</span> $ + $ <span class="z">$z^{2}$</span>
                </div>
                <br />
                <div class="fragment">
                  <span class="vector">$V$</span> $ = \sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} +
                  \textcolor{#DCBD87}{z^{2}}}$
                </div>
              </div>
            </div>
            <div class="item cv fragment">
              <img src="/4/pythagoras-glasses.png" height="500px" />
            </div>
          </div>
        </section>

        <section>
          <h3>Ce qu'on cherche à faire :</h3>
          <p class="fragment">
            Soit <span class="vector">$V$</span>$($<span class="x">$x$</span>$,$<span class="y">$y$</span>$,$<span
              class="z">$z$</span>$)$ un vecteur de magnitude <span class="vector">$M$</span>
          </p>
          <p>
            <span class="fragment">
              <b>Normaliser</b> <span class="vector">$V$</span>, c'est trouver les composantes
              <br /><span class="x">$x_n$</span>, <span class="y">$y_n$</span> et <span class="z">$z_n$</span> du
              vecteur <span class="vector">$V_n$</span> de magnitude
              <span class="vector">$M_n = 1$</span></span>
          </p>
          <aside class="notes">
            Ce qu'on cherche à calculer alors :
            Soit V(x,y,z) un vecteur de magnitude M
            Pour normaliser le vecteur (M = 1), on cherche à calculer :
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item cv">
              <div class="item">
                \[\textcolor{#66ABE1}{x_n} = \frac{\textcolor{#66ABE1}{x}}{\textcolor{#C878E1}{M}}\]
              </div>
              <div class="item">
                \[\textcolor{#9CC281}{y_n} = \frac{\textcolor{#9CC281}{y}}{\textcolor{#C878E1}{M}}\]
              </div>
              <div class="item">
                \[\textcolor{#DCBD87}{z_n} = \frac{\textcolor{#DCBD87}{z}}{\textcolor{#C878E1}{M}}\]
              </div>
            </div>
            <div class="r-stack item-wide ">
              <div class="cv fragment fade-right current-visible">
                <div class="item">
                  \[= \frac{\textcolor{#66ABE1}{x}}{\sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} +
                  \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
                <div class="item">
                  \[= \frac{\textcolor{#9CC281}{y}}{\sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} +
                  \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
                <div class="item">
                  \[= \frac{\textcolor{#DCBD87}{z}}{\sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} +
                  \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
              </div>
              <div class="cv fragment">
                <div class="item">
                  \[= \textcolor{#66ABE1}{x} \times \frac{1}{\sqrt{\textcolor{#66ABE1}{x^{2}} +
                  \textcolor{#9CC281}{y^{2}} + \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
                <div class="item">
                  \[= \textcolor{#9CC281}{y} \times \frac{1}{\sqrt{\textcolor{#66ABE1}{x^{2}} +
                  \textcolor{#9CC281}{y^{2}} + \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
                <div class="item">
                  \[= \textcolor{#DCBD87}{z} \times \frac{1}{\sqrt{\textcolor{#66ABE1}{x^{2}} +
                  \textcolor{#9CC281}{y^{2}} + \textcolor{#DCBD87}{z^{2}}}}\]
                </div>
              </div>
            </div>
          </div>
        </section>

        <section>
          <h3 class="fragment">3 fois par vecteur 💦</h3>
          <h3 class="fragment">60 fois par secondes 🔥</h3>
          <div>
            \[\frac{1}{\sqrt{\textcolor{#66ABE1}{x^{2}} + \textcolor{#9CC281}{y^{2}} + \textcolor{#DCBD87}{z^{2}}}}\]
          </div>
          <br />
          <div class="r-stack">
            <div class="fragment current-visible">
              <code data-trim class="normal">
                1/sqrt(<span class="x">x</span>*<span class="x">x</span> + <span class="y">y</span>*<span class="y">y</span> + <span class="z">z</span>*<span class="z">z</span>);
              </code>
            </div>
            <div class="fragment fade-up">
              <code data-trim class="normal">
                <code class="func">Q_rsqrt</code>(<span class="x">x</span>*<span class="x">x</span> + <span
                class="y">y</span>*<span class="y">y</span> + <span class="z">z</span>*<span class="z">z</span>);
              </code>
            </div>
          </div>
          <aside class="notes">
            Etant donné le nombre de fois où on va avoir besoin de normaliser des vecteurs,
            c'est un calcul qui va être fait très souvent, il est crucial qu'il soit rapide.
          </aside>
        </section>

      </section>

      <!-- 3. La fonction -->
      <section data-background-image="/3/the-function.jpeg" data-transition="fade" class="scrim darkblue">
        <h2 class="highlight-gold">La fonction</h2>
      </section>
      <section data-background-image="/3/the-function.jpeg" class="blurred scrim darkblue">
        <section data-transition="fade">
          <div class="big">
            \[f(x) = \frac{1}{\sqrt{x}}\]
          </div>
          <aside class="notes">
            Cette fonction, elle ne fait qu'une seule chose : elle calcule l'inverse de la racine carrée d'un nombre.
          </aside>
        </section>

        <section data-transition="fade">
          <div style="margin-left: 15%;" class="big">
            <pre class="c clean">
              <code class="fragment" data-trim>
                <script type="text/template">
                  #include <math.h>
                </script>
              </code>
              <code data-trim>
                float y = 1 / sqrt(x);
              </code>
            </pre>
          </div>
          <aside class="notes">
            En C on l'écrirait comme ceci.
            On aurait pas besoin de coder une fonction de calcul de racine carrée,
            on la chopperait dans une lib standard, comme math.h.
          </aside>
        </section>

        <section>
          <img src="/3/cpu-cycles.png" />
          <img class="abs-center-right fragment" src="/3/sweating.jpeg" width="350px" />
          <aside class="notes">
            Le soucis, c'est que calculer des divisions ça prend des plombes, et je vous parle pas des racines carrés.
            C'est des opérations très couteuses en temps de calcul, qu'on va vouloir éviter à tout pris.
          </aside>
        </section>

        <section data-transition="fade">
          <br />
          <div class="cv">
            <div class="item fragment">
              <pre class="c wide smaller clean">
                <code data-trim>
                  float Q_rsqrt( float number ) {
                    long i;
                    float x2, y;
                    const float threehalfs = 1.5F;
  
                    x2 = number * 0.5F;
                    y  = number;
                    i  = * ( long * ) &y;                      // evil floating point bit level hacking
                    i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                    y  = * ( float * ) &i;
                    y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                    // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed
  
                    return y;
                  }
                </code>
              </pre>
            </div>
            <div class="item fragment">
              <img class="abs right" src="/3/the-what.jpeg" />
            </div>
          </div>
          <aside class="notes">
            Mais dans le code source Quake, on ne retrouve pas cette fonction.
            Voici ce qu'on y trouve à la place.
          </aside>
        </section>

        <section data-transition="zoom">
          <code data-id="Q" class="title">Q</code>
          <code data-id="_" class="title">_</code>
          <code data-id="r" class="title">r</code>
          <code data-id="sqrt" class="title">sqrt</code>
          <br />
          <code class="bright highlight-gold">
            <span class="fragment">Quake</span>
            <span class="fragment">Reverse</span>
            <span class="fragment">Square Root</span>
          </code>
          <br />
          <div class="fragment">
            <br />
            <i>The Fast Inverse Square Root Algorithm</i>
          </div>
          <aside class="notes">
            Ou "Fast Inverse Square Root Algorithm"
          </aside>
        </section>

        <section>
          <div class="cv">
            <div class="item">
              <img class="m-b-0" src="/4/prerequis-1.png" />
            </div>
            <div class="item fragment">
              <img class="m-t-0" src="/4/prerequis-2.png" />
            </div>
          </div>
          <aside class="notes">
            Maintenant qu'on a vu à quoi sert cette fonction, on va pouvoir s'intéresser à son implémentation.
            Pour ça, on va d'abord s'armer de 3 prérequis :
            - à quoi sert cette fonction, et pourquoi elle a été écrite
            - la représentation binaire des nombres décimaux, dits "à virgule flottante"
            - et des petits rappels de maths concernant les logarithmes de base 2
            Ne vous inquiétez pas, ça va bien se passer :)
          </aside>
        </section>

      </section>

      <!-- 5. La représentation binaire des nombres à virgules flottantes -->
      <section data-background-image="/5/splash.jpg" data-transition="fade" class="scrim darkblue">
        <h3>Pré-requis n°1</h3>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <h2 class="highlight-gold">They see me floatin<br />They hatin</h2>
      </section>
      <section data-background-image="/5/splash.jpg" class="blurred">

        <section data-auto-animate>
          <div class="cv">
            <div class="item">
              <pre data-id="1" class="c wide smaller clean">
                <code data-trim data-line-numbers="1-4">
                  float Q_rsqrt( float number ) {
                    long i;
                    float x2, y;
                    const float threehalfs = 1.5F;
  
                    x2 = number * 0.5F;
                    y  = number;
                    i  = * ( long * ) &y;                        // evil floating point bit hacking
                    i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                    y  = * ( float * ) &i;
                    y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                    // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed
  
                    return y;
                  }
                </code>
              </pre>
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <pre data-id="1" class="c smaller clean">
            <code data-trim data-line-numbers>
              float Q_rsqrt( float number ) {
                long i;
                float x2, y;
                const float threehalfs = 1.5F;
            </code>
          </pre>
          <div class="cv">
            <div class="item">
              <div class="fragment fade-in-then-semi-out">
                <code class="normal bold">number</code>, un <code class="type bold">float</code> dont on veut
                <br />la racine carrée inversée
              </div>
              <div class="fragment fade-in-then-semi-out">
                <code class="normal bold">i</code>, un <code class="type bold">long</code> sur <strong>32 bits</strong>
              </div>
              <div class="fragment fade-in-then-semi-out	">
                <code class="normal bold">x2</code> et <code class="normal bold">y</code>,
                deux <code class="type bold">float</code>, aussi sur <strong>32 bits</strong>
              </div>
              <div class="fragment">
                <code class="normal bold">threehalfs</code>, un <code class="type bold">const float</code>
                sur <strong>32 bits</strong>,
                <br />initialisé à <strong>1,5</strong>
              </div>
            </div>
          </div>
          <aside class="notes">
            Commençons par lire ces quelques lignes qui, j'en suis sûr, ne présentent pas particulièrement de
            difficulté...
            Enfin ça c'est pas si simple :p

            Déjà quelques questions émergent :
            - Pourquoi on déclare une constante pour 1,5 ?
            - Pourquoi threehalfs et pas threehalves, qui est l'orthographe correcte ?
            - Aucune idée 🤡
          </aside>
        </section>

        <!-- integer -->
        <section>
          <h3>long</h3>
          <h4><code class="normal">long32</code></h4>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant value"
              data-fragment-index="1">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="2">00000000 00000000 00000000 00000001</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="3">00000000 00000000 00000000 00000010</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="4">00000000 00000000 00000000 00000011</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="5">00000000 00000000 00000000 00000100</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="6">01111111 11111111 11111111 11111111</code>
            <code class="fragment instant value" data-fragment-index="7">11111111 11111111 11111111 11111111</code>
          </div>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant normal" data-fragment-index="1">0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="2">1</code>
            <code class="fragment current-visible instant normal" data-fragment-index="3">2</code>
            <code class="fragment current-visible instant normal" data-fragment-index="4">3</code>
            <code class="fragment current-visible instant normal" data-fragment-index="5">4</code>
            <code class="fragment current-visible instant normal" data-fragment-index="6">2147483647</code>
            <code class="fragment instant normal" data-fragment-index="7">-2147483647</code>
          </div>
          <aside class="notes">
            Un long représente un entier (positif ou négatif) sur 32 bits.
            Il peut donc prendre 2^32 valeurs différentes, de -2^31 à 2^31-1.
            le premier bit est le signe, et les 31 autres bits représentent la valeur.

            D'ailleurs, si vous voulez un moyen mnémotechnique simple pour vous souvenir de cette valeur,
            il vous suffit de mémoriser le nombre PI jusqu'à sa 1,867,996,689ème décimale :)

            The numeric string 2147483647 appears at the 1,867,996,680 decimal digit of Pi.
            3.14......86181221809936452346 2147483647 10527835665425671614...
          </aside>
        </section>

        <!-- float -->
        <section data-auto-animate>
          <h3>float</h3>
          <h4><code class="normal">float32</code></h4>
          <br />
          <div class="r-stack">
            <code class="fragment current-visible instant value"
              data-fragment-index="1">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="2">00000000 00000000 00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="3">00000000 00000000.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="4">00000000 00000001.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="5">00000000 00000010.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="6">00000000 00000011.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="7">00000000 00000100.00000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="8">00000000 00000100.10000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="9">00000000 00000100.01000000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="10">00000000 00000100.00100000 00000000</code>
            <code class="fragment current-visible instant value"
              data-fragment-index="11">00000000 00000100.00010000 00000000</code>
            <code class="fragment instant value" data-fragment-index="12">11111111 11111111.00010000 00000000</code>
          </div>
          <br />
          <div class="r-stack">
            <img data-fragment-index="2" class="fragment current-visible abs-center-top" src="/5/thinking.jpeg"
              height="400px" />
            <code class="fragment current-visible instant normal" data-fragment-index="1">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="2">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="3">0.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="4">1.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="5">2.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="6">3.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="7">4.0</code>
            <code class="fragment current-visible instant normal" data-fragment-index="8">4.5</code>
            <code class="fragment current-visible instant normal" data-fragment-index="9">4.25</code>
            <code class="fragment current-visible instant normal" data-fragment-index="10">4.125</code>
            <code class="fragment current-visible instant normal" data-fragment-index="11">4.0625</code>
            <code class="fragment instant normal" data-fragment-index="12">65536.0625</code>
          </div>
          <aside class="notes">
            Un float représente un nombre décimal, ou "nombre à virgule flottante" sur 32 bits.
            On va revenir sur ce terme.

            Question à l'assemblée : comment vous représenteriez un tel nombre, si vous aviez ces 32 bits ?
            -> Oui, on peut mettre un point au milieu, et séparer les bits en deux parties.
            La partie gauche pour la partie entière, et la partie droite pour la partie décimale.

            On aurait donc la partie gauche qui sont des puissance de 2, et la partie droite qui sont des puissance de 2
            négatives : des demi, quart, huitième, 16ème, etc.

            Mais on a un problème : en faisant cela, on réduit drastiquement le maximum représentable !
            On ne peut peut plus stoquer que des nombres compris entre
            -2^16 et 2^16-1, soit 65536 valeurs différentes.

            Ce qui est très cringe !
          </aside>
        </section>

        <section>
          <video autoplay loop muted src="/5/the-worst.webm" height="500px"></video>
        </section>

        <section>
          <br />
          <h3>Du coup, comment on fait ?</h3>
          <br />
          <div class="ch">
            <div class="item fragment">
              On double la taille d'un <code class="type bold">float</code> ?
              <br />
              <code class="normal bold">float32 -> float64</code>
            </div>
            <div class="item fragment">
              Mais en fait <code class="normal bold">float64</code> ça existe déjà,
              <br />
              c'est un <code class="type bold">double</code> 😅
            </div>
          </div>
          <div class="ch">
            <div class="item fragment">
              <br />
              Donc on créer un nouveau <code class="type bold">float128</code> ?
            </div>
            <div class="item fragment">
              <img src="/5/ca-fait-beaucoup.gif" height="250px" />
            </div>
          </div>
          <aside class="notes">
            On est d'accord que ce n'est pas acceptable.
            On pourrait augmenter la taille de notre float, mais ça créer d'autres problèmes :
            - ça prend plus de place en mémoire, le moindre float genre "3.2" prend 64 bits au lieu de 32, le double de
            place,
            - il aurait fallut créer un float128 pour stocker des nombres à plus grande précision (ce que sont les
            double),
            ce qui aurait posé des problèmes d'architectures des processeurs, qui sont conçu pour manipuler des nombres
            sur 32 ou 64 bits.
          </aside>
        </section>

        <section>
          <video class="r-stretch" data-autoplay src="/5/homer-cest-nul.webm"></video>
        </section>

        <section>
          <h4>Heureusement il y a ...</h4>
          <div class="r-stack">
            <img class="fragment current-visible instant" src="/5/findus.png" />
            <div class="fragment instant">
              <h3>La norme</h3>
              <h1 class="highlight-gold">IEEE 754</h1>
            </div>
          </div>
          <aside class="notes">
            Heureusement il y'a Fiiiiiinnnnnduuuuu ... la norme IEEE 754
            C'est ce que se sont dit des gens pour ça que des gens plutôt malins, des gens de l'IEEE
          </aside>
        </section>

        <section>
          <img class="highlight-shadow" src="/5/IEEE-logo.png" height="400px" />
          <p class="fragment"><strong class="small">Institute of Electrical and Electronics Engineers</strong></p>
          <aside class="notes">
            De son nom complet, **l'Institute of Electrical and Electronics Engineers**,
            c'est une organisation internationale qui élabore des normes dans divers domaines, dont l'informatique.
          </aside>
        </section>

        <section>
          <h3>IEEE 754</h3>
          <h4><q>The IEEE Standard for<br /><span class="bright">Floating-Point Arithmetic</span></q></h4>
          <br />
          <p class="fragment">
            Fondée sur deux notions :
          <ol>
            <li class="fragment"><strong data-id="1">la notation scientifique 🧑‍🔬</strong></li>
            <li class="fragment"><strong>le système binaire 0️⃣1️⃣</strong></li>
          </ol>
          </p>
        </section>

        <section>
          <h4>Rappel sur la notation dite "scientifique" des nombres <span class="bright">en base 10</span> :</h4>
          <div class="big">
            <span data-fragment-index="1" class="fragment ieee-mantissa">$4,36$</span>
            <span data-fragment-index="3" class="fragment ieee-exponent">$\times 10^{2}$</span>
          </div>
          <br />
          <div class="ch bold">
            <div data-fragment-index="2" class="item fragment">
              Un nombre décimal <span class="ieee-mantissa">$n$</span> <br />tel que :
              <br />
              $1 \leq$ <span class="ieee-mantissa">$n$</span> $&lt; 10$
            </div>
            <div data-fragment-index="4" class="item fragment">
              une <span class="ieee-exponent">puissance</span> entière<br />de <span class="ieee-exponent">$10$</span>
            </div>
          </div>
          <aside class="notes">
            Comprend 2 parties :
            - un nombre décimal, positif ou négatif, dont la valeur absolue est comprise entre 1 inclus et 10 exclus
          </aside>
        </section>

        <section>
          <h4>En binaire, on passe d'une « colonne » à une autre en multipliant ou en divisant par
            <span class="bright">une puissance de 2</span> :
          </h4>
          <p data-fragment-index="1" class="fragment">Exemple avec $170$</p>
          <div class="r-stack">
            <div data-fragment-index="3" class="ch fragment">
              <div class="item"><code>1</code><br /><span data-fragment-index="4"
                  class="fragment base-2-7">$2^{7}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="5" class="fragment">$2^{6}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="6"
                  class="fragment base-2-5">$2^{5}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="7" class="fragment">$2^{4}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="8"
                  class="fragment base-2-3">$2^{3}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="9" class="fragment">$2^{2}$</span></div>
              <div class="item"><code>1</code><br /><span data-fragment-index="10"
                  class="fragment base-2-1">$2^{1}$</span></div>
              <div class="item"><code>0</code><br /><span data-fragment-index="11" class="fragment">$2^{0}$</span></div>
            </div>
          </div>
          <br />
          <div class="ch">
            <div data-fragment-index="4" class="fragment item"><span class="base-2-7">$128$</span></div>
            <div data-fragment-index="5" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="6" class="fragment item"><span class="base-2-5">$+$ $32$</span></div>
            <div data-fragment-index="7" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="8" class="fragment item"><span class="base-2-3">$+$ $8$</span></div>
            <div data-fragment-index="9" class="fragment item"><span>$+$ $0$</span></div>
            <div data-fragment-index="10" class="fragment item"><span class="base-2-1">$+$ $2$</span></div>
            <div data-fragment-index="11" class="fragment item"><span>$+$ $0$</span></div>
          </div>
          <div class="fragment">
            $= 170$
          </div>
          <aside class="notes">
            En binaire, on passe d'une « colonne » à une autre en multipliant ou en divisant par une puissance de 2.
            Exemple avec 170.
          </aside>
        </section>

        <!-- Notation scientifique binaire -->
        <section>
          <h4>Application de la notation scientifique <br /><span class="bright">en base 2</span> :</h4>
          <div class="ch">
            <div class="item fragment">
              $3$ en binaire <code class="value">11</code>&nbsp;:
              <br />
              <span class="ieee-mantissa">$1,1$</span><span class="ieee-exponent">$\times 2^1$</span>
            </div>
            <div class="item fragment">
              $0,75$ en binaire <code class="value">0,11</code>&nbsp;:
              <br />
              <span class="ieee-mantissa">$1.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
            </div>
          </div>
          <br />
          <div class="ch">
            <div class="item fragment">
              Un nombre décimal <span class="ieee-mantissa">$n$</span> <br />tel que :
              <br />
              $1 \leq$ <span class="ieee-mantissa">$n$</span> $&lt; 2$
            </div>
            <div class="item fragment">
              une <span class="ieee-exponent bold">puissance</span> entière<br />de <span
                class="ieee-exponent">$2$</span>
            </div>
          </div>
          <aside class="notes">
            On peut donc représenter des nombres binaire avec cette notation scientifique de la même manière qu'en base
            10.
            La base a changée (on est passé de 10 à 2), mais le reste fonctionne de la même manière.
            Important : la mantisse est comprise entre 1 inclus et 10 (donc 2) exclus; 1 ≤ _n_ &lt; 2, sa
            -> sa partie entière est donc toujours 1
          </aside>
        </section>

        <section>
          <h4>On dit <code class="type">float</code> car la virgule "flotte" en fonction de l'exposant</h4>
          <div class="fragment">
            Par exemple, si on prend le nombre <code class="value">12,5</code> :
          </div>
          <br />
          <div class="r-stack medium">
            <div class="fragment current-visible instant">
              <code class="value">1100,1 x 2^0</code>
            </div>
            <div class="fragment current-visible instant">
              <code class="value">110,01 x 2^1</code>
            </div>
            <div class="fragment current-visible instant">
              <code class="value">11,001 x 2^2</code>
            </div>
            <div class="fragment current-visible instant">
              <code class="value">1,1001 x 2^3</code>
            </div>
          </div>
        </section>

        <!-- Sign-bit, exponent & mantissa -->
        <section>
          <h3>Un <code class="type">float</code> selon la norme <br /><strong>✨ IEEE 754 ✨</strong></h3>
          <br />
          <div class="cv">
            <div class="item">
              <span data-fragment-index="3" class="fragment bold ieee-exponent ieee-padded">exponent</span>
            </div>
            <div class="item">
              <div class="r-stack">
                <div data-fragment-index="1" class="fragment current-visible instant">
                  <code class="value">00000000 00000000 00000000 00000000</code>
                </div>
                <div data-fragment-index="2" class="fragment current-visible instant">
                  <code class="ieee-sign">0</code> <code>00000000</code> <code>00000000000000000000000</code>
                </div>
                <div data-fragment-index="3" class="fragment current-visible instant">
                  <code class="ieee-sign">0</code> <code class="ieee-exponent ieee-padded">00000000</code>
                  <code>00000000000000000000000</code>
                </div>
                <div data-fragment-index="4" class="fragment instant">
                  <code class="ieee-sign">0</code> <code class="ieee-exponent ieee-padded">00000000</code> <code
                    class="ieee-mantissa">00000000000000000000000</code>
                </div>
              </div>
            </div>
            <div class="item">
              <div class="ch">
                <div data-fragment-index="2" class="item fragment">
                  <span class="bold ieee-sign">sign bit</span>
                </div>
                <div class="item"><!----></div>
                <div data-fragment-index="4" class="item fragment">
                  <span class="bold ieee-mantissa">mantissa</span>
                </div>
              </div>
            </div>
          </div>
          <div data-fragment-index="1" class="fragment fade-in-then-semi-out instant"><strong>32 bits</strong></div>
        </section>

        <!-- Explications détaillées de la normalisation -->
        <section>
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <code class="ieee-sign">&nbsp;Sign bit&nbsp;</code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <code class="ieee-exponent">&nbsp;Exponent&nbsp;</code>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <code class="ieee-mantissa">&nbsp;Mantissa&nbsp;</code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <code><span class="ieee-sign">1</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code>________</code> <code>_______________________</code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000000</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="5" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000001</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="6" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000010</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="7" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000011</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="8" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="9" class="fragment current-visible instant">
              <span class="ieee-exponent ieee-exponent-range bold"><code>[0 255]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="10" class="fragment current-visible instant">
              <span class="ieee-exponent ieee-exponent-range bold"><code>[-127 128]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="11" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="12" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="13" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code>_______________________</code>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="15" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2²³-1]</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="16" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="17" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="18" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">1.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="19" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">1.11111111111111111111111</span></code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span class="ieee-sign">$-$</span> $x$
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{E}$</span>
            </div>
            <div data-fragment-index="5" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{1}$</span>
            </div>
            <div data-fragment-index="6" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{2}$</span>
            </div>
            <div data-fragment-index="7" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{3}$</span>
            </div>
            <div data-fragment-index="8" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="9" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="10" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="11" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4-127}$</span>
            </div>
            <div data-fragment-index="12" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{131-127}$</span>
            </div>
            <div data-fragment-index="13" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $x$<span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="14" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$M$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="15" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$M$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="16" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$\frac{M}{2^{23}}$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="17" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="18" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$1,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="19" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$1,11$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
          </div>
          <aside class="notes">
            Les derniers 23 bits sont ce qu'on appelle la mantisse, du latin "mantissa" :
            signifiant "surplus" (en nombre, en poids, en monnaie…), augmentation, supplément, reste, ou familièrement
            "rabiot"
            Cela nous donne un nombre compris entre 0 et 2^23 -1. Ce n'est pas ce qu'on veut.

            Nous, on veut un nombre entre 1 et 1,9999 (2 exclus)
            On pourrait mettre une virgule après le premier chiffre, mais ça serait du gâchis.
            Pourquoi ça ?
          </aside>
        </section>

        <!-- En binaire, le premier digit est toujours '1' en notation scientifique -->
        <section data-transition="fade">
          <table>
            <thead>
              <tr>
                <th>Decimal</th>
                <th>Binary</th>
                <th>Scientific base 2</th>
              </tr>
            </thead>
            <tbody>
              <tr data-fragment-index="1" class="fragment">
                <td>$3$</td>
                <td><code class="value">11</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^1$</span>
                    </div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^1$</span></div>
                  </div>
                </td>
              </tr>
              <tr data-fragment-index="2" class="fragment">
                <td>$0.75$</td>
                <td><code class="value">0.11</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
                    </div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.1$</span><span class="ieee-exponent">$\times 2^{-1}$</span>
                    </div>
                  </div>
                </td>
              </tr>
              <tr data-fragment-index="3" class="fragment">
                <td>$4.625$</td>
                <td><code class="value">101.101</code></td>
                <td>
                  <div class="r-stack">
                    <div data-fragment-index="1" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep-inv">$1$</span>$.00101$</span><span class="ieee-exponent">$\times
                        2^{2}$</span></div>
                    <div data-fragment-index="4" class="fragment"><span class="ieee-mantissa"><span
                          class="binary-rep">$1$</span>$.00101$</span><span class="ieee-exponent">$\times 2^{2}$</span>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <br />
          <p class="fragment bright">ℹ️ Le premier chiffre est <span class="underline">toujours</span> $1$</p>
          <aside class="notes">
            En notation scientifique, le premier digit d'un nombre est par définition différent de 0.
            Hors en base 2, il n'existe qu'un chiffre différent de 0 : 1 !
            Si on sait que le 1er chiffre sera toujours 1, cela ne sert à rien de le stocker.
          </aside>
        </section>

        <!-- Suite et fin explications -->
        <section data-auto-animate>
          <div data-fragment-index="6" class="fragment instant">
            <h2 class="highlight-gold">IEEE 754</h2>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">0.0000000000000000000000</span></code>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.00000000000000000000000</span></code>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span
                class="ieee-mantissa ieee-mantissa-range-2 bold"><code>[1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2[</code></span>
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">10000100</span></code>
              <code><span class="ieee-mantissa">.11111111111111111111111</span></code>
            </div>
            <div data-fragment-index="5" class="fragment instant">
              <code><span class="ieee-sign">0</span></code> <code><span class="ieee-exponent">00000000</span></code>
              <code><span class="ieee-mantissa">.00000000000000000000000</span></code>
            </div>
          </div>
          <br />
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="ieee-mantissa">$0,00$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="3" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> <span class="bright">$1$</span><span class="ieee-mantissa">$,00$</span>
              <span class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant">
              <span class="ieee-sign">$+$</span> $1$<span class="ieee-mantissa">$,11$</span> <span
                class="ieee-exponent">$\times 2^{4}$</span>
            </div>
            <div data-fragment-index="5" data-id="1" class="fragment medium">
              <span class="ieee-sign">$+ ou -$</span> <span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span>
              <span class="ieee-exponent">$\times 2^{E-127}$</span>
            </div>
          </div>
          <div data-fragment-index="6" class="fragment instant">
            <img src="/5/nice.gif" />
          </div>
          <aside class="notes">
            En divisant par 2^23, on passe d'un nombre compris entre 0 et 2^23 -1 à un nombre compris entre 0 et 1
            En ajoutant un '1' arbitraire à notre nombre,
            on passe d'un nombre compris entre 0 et 1 à un nombre compris entre 1 et 2.
          </aside>
        </section>

        <section data-auto-animate>
          <div class="medium">
            <h4>Cas nominal</h4>
            <div class="r-stack">
              <div data-id="1" data-fragment-index="0" class="fragment current-visible preload instant">
                <span class="ieee-sign">$+ ou -$</span> <span class="ieee-mantissa">$(1 +\frac{M}{2^{23}})$</span>
                <span class="ieee-exponent">$\times 2^{E-127}$</span>
              </div>
              <div class="fragment instant">
                <span class="ieee-sign still-log">$+ ou -$</span> <span class="ieee-mantissa">$(1
                  +\frac{M}{2^{23}})$</span>
                <span class="ieee-exponent">$\times 2^{E-127}$</span>
              </div>
            </div>
            <div class="ch">
              <div class="item">
                <div class="r-stack">
                  <div class="fragment current-visible regular">
                    \[f(x) = \frac{1}{\sqrt{-x}}\]
                  </div>
                  <div class="fragment regular">
                    \[f(x) = \frac{1}{\textcolor{#FF3D33}{\sqrt{-x}}}\]
                  </div>
                </div>
              </div>
              <div class="item fragment">
                <img src="/5/big-nono.jpeg" />
              </div>
            </div>
          </div>
          <aside class="notes">
            Dans notre cas, on sait que le signe sera toujours positif, donc on peut l'ignorer.
            En effet, si on en vient à calculer la racine carrée d'un nombre négatif, il s'est passé un truc pas net !
          </aside>
        </section>

        <section>
          <div class="medium">
            <h4>Dans notre cas</h4>
            $y = $<span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span> <span class="ieee-exponent">$\times
              2^{E-127}$</span>
          </div>
          <br />
          <div class="fragment">
            <h5>Représentation binaire</h5>
            <div class="r-stack">
              <div class="fragment current-visible instant">
                <code class="normal">0</code>
                <code class="normal">00000000</code>
                <code><span class="ieee-mantissa">00000000000000000000000</span></code>
                <div>
                  <span class="ieee-mantissa">$M$</span>
                </div>
              </div>
              <div class="fragment current-visible instant">
                <code class="normal">0</code>
                <code class="normal">00000000</code>
                <code><span class="ieee-mantissa">000000000000000</span><span class="ieee-exponent">00000000</span></code>
                <div>
                  <span class="ieee-exponent">$E$</span> $+$ <span class="ieee-mantissa">$M$</span>
                </div>
              </div>
              <div class="fragment instant">
                <code class="normal">0</code>
                <code><span class="ieee-exponent">00000000</span></code>
                <code><span class="ieee-mantissa">00000000000000000000000</span></code>
                <div>
                  <span class="ieee-exponent">$E \times 2^{23}$</span> $+$ <span class="ieee-mantissa">$M$</span>
                </div>
              </div>
            </div>
          </div>
        </section>

      </section>

      <!-- 6. Log2, Log2(1+x) et autre filouteries -->
      <section data-background-image="/6/logarithms-book.jpeg" data-transition="fade" class="scrim grey">
        <h3>Pré-requis n°2</h3>
        <br />
        <br />
        <h2 class="highlight-gold">Filouteries logarithmiques</h2>
      </section>
      <section data-background-image="/6/logarithms-book.jpeg" class="blurred">

        <section>
          <img class="fragment" src="/5/log2-undertaker.jpg" />
          <aside class="notes">
            Et maintenant, pour aucune raison apparente, on va prendre le logarithme de notre nombre.
          </aside>
        </section>

        <section>
          <div class="math">
            $y =$ <span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span> <span class="ieee-exponent">$\times
              2^{E-127}$</span>
          </div>
          <hr class="fragment" />
          <div class="text-left">
            <div class="math fragment fade-in-then-semi-out" style="margin-left: 140px;">
              $\log_2(y) = \log_2($<span class="ieee-mantissa">$(1 + \frac{M}{2^{23}})$</span>
              <span class="ieee-exponent">$\times 2^{E-127}$</span>$)$
            </div>
            <div class="math fragment fade-in-then-semi-out" style="margin-left: 300px;">
              $= \log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
              $+ \log_2($<span class="ieee-exponent">$2^{E-127}$</span>$)$
            </div>
            <div class="r-stack">
              <div class="math fragment current-visible" style="margin-left: 300px;">
                $= \log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
                $+$ <span class="ieee-exponent">$E-127$</span>
              </div>
              <div class="math fragment" style="margin-left: 300px;">
                $=$ <span class="still-log">$\log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$</span>
                $+$ <span class="ieee-exponent">$E-127$</span>
              </div>
            </div>
          </div>
          <img class="fragment wtf-cat" src="/6/wtf-cat.jpeg" />
          <aside class="notes">
            Pourquoi on fait ça ? Mais parce qu'on peut virer l'exposant !
            Mais du coup maintenant on est bloqué avec un gros logarithme en plein milieu...
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item fragment">
              <img class="noshadow" src="/6/wojak-dumb.png" />
              <b>moi</b>
            </div>
            <div class="item fragment">
              <img class="noshadow" src="/6/wojak-smart.png" />
              <b>les devs de Quake 3</b>
            </div>
          </div>
          <aside class="notes">
            La différence entre moi et les gens qui ont développé Quake c'est qu'ils avaient une astuce pour
            se débarraser du logarithme restant
          </aside>
        </section>

        <section data-auto-animate>
          <video class="motion-canvas" data-id="1" data-autoplay data-src="/6/log-one-plus-x.mp4"></video>
        </section>
        <section data-auto-animate>
          <video class="motion-canvas" data-id="1" data-autoplay data-src="/6/plus-mu.mp4"></video>
        </section>

        <section>
          <div class="text-left" style="margin-left: 15%;">
            <div class="math fragment preload fade-in-then-semi-out">
              $\log_2(y) = \log_2($<span class="ieee-mantissa">$1 + \frac{M}{2^{23}}$</span>$)$
              $+$ <span class="ieee-exponent">$E-127$</span>
            </div>
            <div class="math math-pad-log fragment fade-in-then-semi-out">
              $= $ <span class="ieee-mantissa">$\frac{M}{2^{23}}$</span>
              <span class="mu">$+ \mu$ </span>$+$ <span class="ieee-exponent">$E-127$</span>
            </div>
            <div class="r-stack math-pad-log-stack">
              <div class="math fragment current-visible">
                $= \frac{1}{2^{23}}$
                $($<span class="binary-rep-inv"><span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                    class="ieee-mantissa">$M$</span></span>$)$
                $- 127$ <span class="mu">$+ \mu$</span>
              </div>
              <div class="math fragment instant">
                $= \frac{1}{2^{23}}$
                $($<span class="binary-rep"><span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                    class="ieee-mantissa">$M$</span></span>$)$
                $- 127$ <span class="mu">$+ \mu$</span>
              </div>
            </div>
          </div>
          <div class="fragment">
            <img src="/6/binary-rep.png" />
          </div>
          <aside class="notes">
            On peut remplacer alors !
          </aside>
        </section>

        <section>
          <h3>Et alors c'est incroyable !</h3>
          <h4 class="fragment">Car cela signifie que :</h4>
          <br />
          <div class="fragment">
            <div class="medium">
              $\log_2(y) \approx$ <span class="ieee-exponent">$E \times 2^{23}$</span>$ + $<span
                class="ieee-mantissa">$M$</span>
            </div>
            <b class="fragment medium highlight-gold">sa propre représentation binaire !</b>
            <br />
            <br />
            <div class="fragment muted">(scale de $1/2^{23}$ et shifté de $-127 + \mu$<br />mais tranquille)</div>
          </div>
          <aside class="notes">
            Résumons ce qu'on a fait :
            - on a pris le log de base 2 de notre expression (notre float normalisé IEEE 754)
            - dans ce log, on a retrouvé la représentation binaire de notre float
            -> celà signifie que : la représentation binaire de notre float est (presque) égale à son log2
          </aside>
        </section>

      </section>

      <section data-background-image="/6/dark-matrix.jpeg" data-transition="fade" class="scrim">
        <section>
          <h2>Maintenant, vous êtes prêts</h2>
          <img src="/6/we-ready.gif" />
        </section>
        <!-- <section>
          <video data-autoplay data-src="/6/going-dark.mov"></video>
          <h3>Bravo Six, Going Dark</h3>
        </section> -->
        
      </section>

      <!-- 7. Le langage C en sueur -->
      <section data-background-image="/7/splash.png" data-transition="fade" class="scrim">
        <h3>Étape n°1</h3>
        <h2 class="highlight-gold">The Evil Bit Hack</h2>
        <div style="padding-bottom: 400px;"></div>
      </section>
      <section data-background-image="/7/splash.png" class="blurred scrim darkgrey">
        <section data-transition="fade">
          <div class="r-stack">
            <pre data-id="1" class="fragment current-visible c wide smaller clean">
              <code data-trim data-line-numbers>
                float Q_rsqrt( float number ) {
                  long i;
                  float x2, y;
                  const float threehalfs = 1.5F;
  
                  x2 = number * 0.5F;
                  y  = number;
                  i  = * ( long * ) &y;                        // evil floating point bit hacking
                  i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                  y  = * ( float * ) &i;
                  y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                  // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed
  
                  return y;
                }
              </code>
            </pre>
            <pre data-id="1" class="fragment c wide smaller clean">
              <code data-trim data-line-numbers="8,10">
                float Q_rsqrt( float number ) {
                  long i;
                  float x2, y;
                  const float threehalfs = 1.5F;
  
                  x2 = number * 0.5F;
                  y  = number;
                  i  = * ( long * ) &y;                        // evil floating point bit hacking
                  i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                  y  = * ( float * ) &i;
                  y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                  // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed
  
                  return y;
                }
              </code>
            </pre>
          </div>
          
          <aside class="notes">
            Le commentaire "evil floating point bit level hacking" ne nous aide pas trop sur ce coup là...
          </aside>
        </section>

        <section data-auto-animate>
          <code class="bold normal medium" data-id="1">
            i = * ( <code class="type">long</code> * ) &y
          </code>
          <img class="fragment" src="/7/cringe-kid.webp" height="400px" />
          <aside class="notes">
            Si vous avez déjà fait du C ou du C++, vous êtes sûrement familiers avec le concept de pointeur.
          </aside>
        </section>

        <section>
          <h3>C Symbol Table</h3>
          <div class="r-stack">
            <table data-fragment-index="1" class="fragment current-visible fade-up">
              <tr>
                <th>Symbol</th>
                <th>Address</th>
                <th>Type</th>
              </tr>
              <tr>
                <td><code class="normal">i</code></td>
                <td><code class="address">0xBF6CC739</code></td>
                <td><code class="type">int</code></td>
              </tr>
              <tr>
                <td><code class="normal">x2</code></td>
                <td><code class="address">0xEA3FC4F7</code></td>
                <td><code class="type">float</code></td>
              </tr>
              <tr>
                <td><code class="bold normal">y</code></td>
                <td><code class="bold address">0x0B00B135</code></td>
                <td><code class="bold type">float</code></td>
              </tr>
              <tr>
                <td><code class="normal">threehalfs</code></td>
                <td><code class="address">0x5EE7F9A1</code></td>
                <td><code class="type">float</code></td>
              </tr>
            </table>
          </div>
          <div data-fragment-index="1" class="fragment fade-left symbol-table-arrow">&lt;</div>
        </section>

        <section>
          <code class="bold normal medium" data-id="1">
            i = ( <code class="type">long</code> ) y
          </code>
          <br />
          <br />
          <q class="fragment">
            <span class="fragment">La <b class="emphas">valeur</b> de la variable <b class="type">float</b> <code
                class="normal">y</code></span>
            <br />
            <span class="fragment">est <b class="emphas">castée</b> en tant que <b class="type">long</b></span>
            <br />
            <span class="fragment">et <b class="emphas">assignée</b> à la variable <b class="type">long</b> <code
                class="normal">i</code></span>
          </q>
          <aside class="notes">
            On va le déchiffrer ensemble.
            Certains auront déjà compris qu'il s'agit d'un cast.
            En C, si on veut cast un float en long, on peut faire ça
          </aside>
        </section>

        <section>
          <code class="bold normal medium">
            i = <span data-fragment-index="5" class="fragment">*</span> <span data-fragment-index="3" class="fragment">( <code class="type">long</code>
          * )</span> <span data-fragment-index="1" class="fragment">&y</span>
          </code>
          <br />
          <br />
          <ol>
            <li data-fragment-index="2" class="fragment fade-in-then-semi-out">
              <b class="address">L'adresse</b> mémoire de <code class="normal">y</code> (c'est un pointeur)
            </li>
            <li data-fragment-index="4" class="fragment fade-in-then-semi-out">
              est castée en tant qu'<b class="address">adresse</b> d'un <code class="type">long</code>
            </li>
            <li data-fragment-index="6" class="fragment fade-in-then-semi-out">
              On lit la <b class="emphas">valeur</b> présente à cette <b class="address">adresse</b>, comme si c'était
              un <code class="type">long</code> 
            </li>
          </ol>
          <aside class="notes">
            Mais ici, ce n'est pas tout à fait ce qu'il se passe.
            Si vous avez déjà fait du C ou du C++, vous êtes sûrement familiers avec le concept de pointeurs et
            d'adresses.
            On va lire la ligne de droite à gauche pour mieux comprendre :
            - on récupère l'adresse mémoire de y : c'est une référence, un pointeur vers un float
            - si on s'arrête là, C nous engueule avec un type mismatch !
            - i est un long, pas un float *
            - on dit à C : "tqt, je sais qu'à cette adresse, c'est un pointeur vers un long"
            - si on s'arrête là, C nous engueule encore avec un type mismatch !
            - i est un long, pas un long *
            - on a besoin de cette dernière étoile pour déréférencer le pointeur (on récupère la valeur vers laquelle il
            pointe)
            - un pointeur déréférencé d'un long, est un long, on est bon !
          </aside>
        </section>

        <section>
          <h3>On résume :</h3>
          <div>
            <code class="bold normal medium">
              i = * ( <code class="type">long</code> * ) &y
            </code>
          </div>
          <br />
          <table class="fragment small">
            <tr>
              <th>Symbole</th>
              <th>Type</th>
              <th>Valeur</th>
              <th>Bits</th>
            </tr>
            <tr class="fragment">
              <td><code class="normal">y</code></td>
              <td><code class="type">float</code></td>
              <td><code>4,36</code></td>
              <td><code
                  class="small"><span class="ieee-sign">0</span><span class="ieee-exponent">10000001</span><span class="ieee-mantissa">00101000...</span></code>
              </td>
            </tr>
            <tr class="fragment">
              <td><code class="normal">i</code></td>
              <td><code class="type">long</code></td>
              <td><code>1083441152</code></td>
              <td><code class="small value">01000000100101000...</code></td>
            </tr>
          </table>
          <aside class="notes">
            Donc maintenant, que fait C lorqu'on lui demande la valeur de y ?
            Il va lire les bits de `y` comme si c'était un long et les assigner à `i` !
          </aside>
        </section>

        <section data-auto-animate>
          <div class="ch">
            <div data-fragment-index="1" class="item fragment">
              <br />
              <img class="highlight-shadow" src="/7/cordons-bleus.png" />
            </div>
            <div data-fragment-index="3" class="item fragment">
              <img class="highlight-shadow" src="/7/ps5-box.webp" />
            </div>
          </div>
          <img data-fragment-index="2" class="fragment highlight-shadow price-tag" src="/7/price-tag.png" />
        </section>
        <section data-auto-animate>
          <div class="ch">
            <div class="item">
              <br />
              <img class="highlight-shadow" src="/7/cordons-bleus.png" />
            </div>
            <div class="item">
              <img class="highlight-shadow" src="/7/ps5-box.webp" />
            </div>
          </div>
          <img class="highlight-shadow price-tag-2" src="/7/price-tag.png" />
        </section>

        <section>
          <div class="r-stack">
            <div>
              <img src="/7/cashier.jpeg" height="600px" />
              <img class="fragment highlight-shadow c-logo-cashier" src="/7/c-logo.png" />
            </div>
            <div class="fragment">
              <img class="noshadow" src="/7/pranked.png" height="600px" />
            </div>
          </div>
        </section>

        <section>
          <div class="r-stack">
            <pre class="c clean big fragment preload current-visible">
              <code data-trim data-ln-start-from="8" data-line-numbers="1,3">
                  i  = * ( long * ) &y;
                  i  = 0x5f3759df - ( i >> 1 );
                  y  = * ( float * ) &i;
              </code>
            </pre>
            <pre class="c clean big fragment">
              <code data-trim data-ln-start-from="8" data-line-numbers="2">
                  i  = * ( long * ) &y;
                  i  = 0x5f3759df - ( i >> 1 );  // wtf?
                  y  = * ( float * ) &i;
              </code>
            </pre>
          </div>
          <aside class="notes">
            On voit que la ligne 8 qu'on vient d'analyser et la ligne 10 juste après, c'est la même opération,
            mais dans l'autre sens.
            ça veut dire qu'entre les deux, il se passe quelque chose qui doit transformer i, la représentation binaire
            de notre float y, en la représentation binaire de 1/sqrt(y).
          </aside>
        </section>

      </section>

      <!-- 8. What the fuck -->
      <section data-background-image="/8/wtf-jackie.jpeg" data-transition="fade" class="scrim lightgrey">
        <h3>Étape n°2</h3>
        <h2 class="highlight-gold">What the f*ck</h2>
      </section>
      <section data-background-image="/8/wtf-jackie.jpeg" class="blurred scrim grey">
        <section data-transition="fade">
          <pre data-id="1" class="c wide smaller clean">
            <code data-trim data-line-numbers="9">
              float Q_rsqrt( float number ) {
                long i;
                float x2, y;
                const float threehalfs = 1.5F;

                x2 = number * 0.5F;
                y  = number;
                i  = * ( long * ) &y;                        // evil floating point bit hacking
                i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                y  = * ( float * ) &i;
                y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed

                return y;
              }
            </code>
          </pre>
          <aside class="notes">
            On arrive à cette fameuse ligne...
          </aside>
        </section>

        <section data-transition="fade" data-auto-animate>
          <div data-id="1">
            <code data-id="1" data-trim class="normal regular">
            <span class="opaque">i = <code class="value">0x5f3759df</code> - (</span>
            <span>i >> <code class="value">1</code></span>
            <span class="opaque">);</span>
            </code>
          </div>
          <img class="fragment" src="/8/wtf-6.jpeg" height="400px" />
          <aside class="notes">
            Là, c'est même plus C le problème, c'est carrément des hiéroglyphes
            C'est quoi ce nombre hexa complètement arbitraire ?
            Pourquoi on fait un i deux fois plus grands que 1 ?
            C'est ce qu'on va voir ici !
          </aside>
        </section>

        <section data-auto-animate>
          <div data-id="1">
            <code data-trim class="normal regular">
              <span class="semi-trans">i = <code class="value">0x5f3759df</code> - (</span>
            <span>i >> <code class="value">1</code></span>
            <span class="semi-trans">);</span>
            </code>
          </div>
          <br />
          <h3 class="fragment">Bitshifting !</h3>
          <br />
          <div class="ch medium">
            <div class="item">
              <pre class="js fragment fade-in-then-semi-out"><code>long i = 6 // 110</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i &lt;&lt; 1 // 1100, 12</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i >> 1 // 11, 3</code></pre>
            </div>
            <div class="item">
              <pre class="js fragment fade-in-then-semi-out"><code>long i = 7 // 111</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i &lt;&lt; 1 // 1110, 14</code></pre>
              <pre class="js fragment fade-down fade-in-then-semi-out"><code>i = i >> 1 // 11, 3</code></pre>
            </div>
          </div>
          <aside class="notes">
            Bitshift un nombre vers la gauche revient à le multiplier par 2
            Vers la droite, à le diviser par 2
            Et oui, le bitshift arrondi à l'entier inférieur, c'est fâcheux, mais ça a le mérite d'être extrèmement plus
            rapide que de faire une division classique.
          </aside>
        </section>

        <section>
          <h3>Qu'est-ce qu'on essaye de faire déjà ?</h3>
          <br />
          <div class="text-left">
            <div class="ch fragment">
              <div class="item">
                <b>On cherche ça :</b><br />
              </div>
              <div class="item">
                <code class="normal">
                  <code class="value">1</code>/<code class="func">sqrt</code>(y)
                </code>
              </div>
            </div>
            <div class="ch fragment">
              <div class="item">
                <b>On a :</b><br />
              </div>
              <div class="item">
                <code class="normal">
                  i ≈ <code class="func">log2</code>(y)
                </code>
              </div>
            </div>
            <div class="ch fragment">
              <div class="item">
                <b>Si on arrive à faire :</b><br />
              </div>
              <div class="item">
                <code class="normal">
                  i ≈ <code class="func">log2</code>(<code class="value">1</code>/<code class="func">sqrt</code>(y))
                </code>
              </div>
            </div>
            <div class="ch fragment">
              <div class="item">
                <b>Alors avec :</b><br />
              </div>
              <div class="item">
                <code class="normal">
                  y = * (<code class="type">float</code>*) &i;
                </code>
              </div>
            </div>
            <div class="ch fragment">
              <div class="item">
                <b>On pourra obtenir :</b><br />
              </div>
              <div class="item">
                <code class="normal">
                  y ≈ <code class="value">1</code>/<code class="func">sqrt</code>(y)
                </code>
              </div>
            </div>
          </div>
          <aside class="notes">
            Rappelez vous : on a prouvé que la représentation binaire d'un float est son propre log, but scaled and
            shifted.
            L'opération inverse est vraie aussi : si on part d'un log, on peut retrouver la représentation binaire du
            float, et donc la valeur du float en appliquant le scale de 2^-23 et le shift de 127.
          </aside>
        </section>

        <section>
          <div class="big">
            <span>$\frac{1}{\sqrt{y}} = $</span> <span class="fragment">$y^{-1/2}$</span>
          </div>
          <hr class="fragment" />
          <div class="text-left" style="margin-left: 15%;">
            <span class="fragment medium math">$\log_2(\frac{1}{\sqrt{y}}) = $</span>
            <span class="fragment medium math">$\log_2(y^{-1/2})$</span>
            <div class="fragment medium math" style="margin-left: 270px;">$= -\frac{1}{2} \cdot \log_{2}(y)$</div>
            <div class="fragment medium math" style="margin-left: 270px;">$= -\frac{\log_{2}(y)}{2}$</div>
          </div>
          <aside class="notes">
            log(1/sqrt(y)) = log(y^{-1/2}) = -1/2 * log(y)
            donc log(1/sqrt(y)) = - (i >> 1)
            on a maintenant dans i : une approximation de log(1/sqrt(y))
            repasser les bits de i dans y nous donne une approximation de 1/sqrt(y)
          </aside>
        </section>

        <section>
          <div data-fragment-index="1" class="fragment big">
            <code class="normal">
            i ≈ <code class="value">log2(y)</code>
            </code>
          </div>
          <hr data-fragment-index="2" class="fragment" />
          <div class="r-stack medium">
            <div data-fragment-index="2" class="fragment current-visible instant">$\log_2(\frac{1}{\sqrt{y}}) =
              -\frac{\log_{2}(y)}{2}$</div>
            <div data-fragment-index="3" class="fragment instant">$\log_2(\frac{1}{\sqrt{y}}) \approx -\frac{i}{2} $
            </div>
          </div>
          <hr data-fragment-index="4" class="fragment" />
          <div data-fragment-index="4" class="fragment medium">
            <code class="normal">
              log2(1/√y) ≈ - (i >> <code class="value">1</code>)
            </code>
          </div>
          <aside class="notes">
            On a dit que dans i, on avait stocké log2(y), sans le shift et le scale.
          </aside>
        </section>

        <section data-auto-animate>
          <div class="r-stack">
            <code data-fragment-index="1" data-trim class="fragment preload current-visible instant normal regular">
              <span class="semi-trans">i = <code data-id="1" class="value">0x5f3759df</code></span> - (
            i >> <code class="value">1</code> )<span class="semi-trans">;</span>
            </code>
            <code data-fragment-index="2" data-trim class="fragment instant normal regular">
                <span class="semi-trans">i = </span><code class="value">0x5f3759df</code><span class="semi-trans"> - (
              i >> <code class="value">1</code> );</span>
            </code>
          </div>
          <img data-fragment-index="2" class="fragment" src="/8/wtf-cat.gif" />
          <aside class="notes">
            Ça explique déjà cette histoire de "-(i>>1)".
            Mais il reste encore un mystère : pourquoi ce nombre hexa ?
          </aside>
        </section>

        <section data-auto-animate>
          <code data-id="1" class="medium value">0x5f3759df</code>
          <br />
          <img src="/8/magic-shia.gif" height="300px" />
          <br />
          <h2>The magic number 🪄</h2>
        </section>

        <section data-auto-animate>
          <h3>Comment il a été trouvé ?</h3>
          <div class="ch">
            <div class="item fragment">
              <img class="highlight-shadow" src="/8/trial-and-error.png" height="400px" />
              <p><b>À taton ?</b></p>
            </div>
            <div class="item fragment">
              <img src="/8/wtf-girl.webp" />
              <br />
              <br />
              <div data-id="1"><b>Par les maths ?</b></div>
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <div data-id="1">
            <b class="big">Par les maths ?</b>
            <p class="muted">speedrun any%</p>
          </div>
          <div class="r-stack">
            <div data-fragment-index="1" class="fragment current-visible instant medium">\[Γ = \frac{1}{\sqrt{y}}\]
            </div>
            <div data-fragment-index="2" class="fragment current-visible instant medium">\[\log_2(Γ) =
              \log_2(\frac{1}{\sqrt{y}})\]</div>
            <div data-fragment-index="3" class="fragment current-visible instant medium">\[\log_2(Γ) =
              -\frac{1}{2}\log_2(y)\]
            </div>
            <div data-fragment-index="4" class="fragment current-visible instant medium">\[\log_2(Γ) =
              -\frac{1}{2}\log_2(y)\]</div>
            <div data-fragment-index="5" class="fragment current-visible instant smaller">
              $\frac{1}{2^{23}}($<span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span
                  class="ieee-mantissa">$M_Γ$</span></span>$) - 127$ <span class="mu">$+ \mu$</span>
              $ = -\frac{1}{2}(\frac{1}{2^{23}}($<span class="ieee-exponent">$E_y \times 2^{23}+ $<span
                  class="ieee-mantissa">$M_y$</span></span>$) - 127$ <span class="mu">$+ \mu$</span>$)$
            </div>
            <div data-fragment-index="6" class="fragment current-visible instant smaller">
              $\frac{1}{2^{23}}($<span class="still-log"><span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span
                    class="ieee-mantissa">$M_Γ$</span></span></span>$) - 127$ <span class="mu">$+ \mu$</span>
              $ = -\frac{1}{2}(\frac{1}{2^{23}}($<span class="ieee-exponent">$E_y \times 2^{23}+ $<span
                  class="ieee-mantissa">$M_y$</span></span>$) - 127$ <span class="mu">$+ \mu$</span>$)$
            </div>
            <div data-fragment-index="7" class="fragment current-visible instant smaller">
              $\frac{1}{2^{23}}($<span class="still-log"><span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span
                    class="ieee-mantissa">$M_Γ$</span></span></span>$) - 127$ <span class="mu">$+ \mu$</span>
              $ = -\frac{1}{2}(\frac{1}{2^{23}}($<span class="ieee-exponent">$E_y \times 2^{23}+ $<span
                  class="ieee-mantissa">$M_y$</span></span>$) - 127$ <span class="mu">$+ \mu$</span>$)$
              <img class="abs-center" src="/8/cringe-kid.jpg" />
            </div>
            <div data-fragment-index="8" class="fragment current-visible instant small">
              <span class="still-log"><span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span
                    class="ieee-mantissa">$M_Γ$</span></span></span>
              $ = \frac{3}{2}2^{23}(127 - \mu) - \frac{1}{2}($<span class="ieee-exponent">$E_y \times 2^{23}+ $<span
                  class="ieee-mantissa">$M_y$</span></span>$)$
            </div>
            <div data-fragment-index="9" class="fragment current-visible instant small">
              <br />
              <span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span class="ieee-mantissa">$M_Γ$</span></span>
              <span>$ = \frac{3}{2}2^{23}(127 - \mu) - \frac{1}{2}($<span class="ieee-exponent">$E_y \times 2^{23}+
                  $<span class="ieee-mantissa">$M_y$</span></span>$)$
              </span>
              <br />
              <br />
              <code class="normal" style="margin-left: 150px;">
                = <code class="value">1597463007</code> - log2(y)/2
              </code>
            </div>
            <div data-fragment-index="10" class="fragment instant small">
              <br />
              <span class="ieee-exponent">$E_Γ \times 2^{23}+ $<span class="ieee-mantissa">$M_Γ$</span></span>
              <span>$ = \frac{3}{2}2^{23}(127 - \mu) - \frac{1}{2}($<span class="ieee-exponent">$E_y \times 2^{23}+
                  $<span class="ieee-mantissa">$M_y$</span></span>$)$
              </span>
              <br />
              <br />
              <code class="normal" style="margin-left: 150px;">
                = <code class="value">0x5f3759df</code> - ( i >> <code class="value">1</code> )
              </code>
            </div>
          </div>
          <div data-fragment-index="4" class="fragment current-visible">
            <span class="still-log">
              $\frac{1}{2^{23}}($<span class="ieee-exponent">$E \times 2^{23}+ $<span
                  class="ieee-mantissa">$M$</span></span>$) - 127$ <span class="mu">$+ \mu$</span>
            </span>
          </div>
        </section>

        <section data-auto-animate>
          <h3>Comment il a été trouvé ?</h3>
          <div class="ch">
            <div class="item">
              <img class="highlight-shadow" src="/8/trial-and-error.png" height="400px" />
              <div data-id="2"><b>À taton ?</b></div>
            </div>
            <div class="item">
              <img src="/8/wtf-girl.webp" />
              <br />
              <br />
              <div data-id="1"><b>Par les maths ?</b></div>
            </div>
          </div>
        </section>

        <!-- Exemple complet -->
        <section data-auto-animate>
          <div data-id="2"><b class="big">À taton ?</b></div>
          <hr />
          <p class="fragment">
            <code class="normal">
              <code class="type">float</code> y = <code class="value">12.5;</code>
            </code>
          </p>
          <div class="fragment">
            <code class="normal">0</code>
            <code><span class="ieee-exponent">10000010</span></code>
            <code><span class="ieee-mantissa">10010000000000000000000</span></code>
          </div>
          <p class="fragment">
            <code class="normal">
              <code class="type">long</code> i = * (long *) &y;
            </code>
          </p>
          <div class="fragment">
            <code class="normal">0</code>
            <code class="value">10000010</code>
            <code class="value">10010000000000000000000</code>
          </div>
          <p class="fragment">
            <code class="normal">
              i = i >> 1;
            </code>
          </p>
          <div class="r-stack">
            <div class="fragment current-visible instant">
              <code class="normal">0</code>
              <code class="value">01000001</code>
              <code class="value">01001000000000000000000</code>
            </div>
            <div data-id="2" class="fragment instant">
              <code class="normal">0</code>
              <code class="ieee-exponent">01000001</code>
              <code class="value">01001000000000000000000</code>
              <span class="ieee-exponent exponent-divided"><b>E -> E/2</b></span>
            </div>
          </div>
          <aside class="notes">
            Regardons de plus près ce qu'on a fait avec un exemple
          </aside>
        </section>

        <section data-auto-animate>
          <p>
            <code class="normal">
              i = i >> 1;
            </code>
          </p>
          <div data-id="2">
            <code class="normal">0</code>
            <code class="value">01000001</code>
            <code class="value">01001000000000000000000</code>
          </div>
          <p class="fragment">
            <b class="emphas">Le magic number</b> : <code class="value">0x5f3759df</code>
          </p>
          <div class="fragment">
            <code class="normal">0</code>
            <code class="value">10111110</code>
            <code class="value">01101110101100111011111</code>
          </div>
          <p class="fragment">
            <code class="normal">
              <code class="value">0x5f3759df</code> - ( i >> 1 );
            </code>
          </p>
          <div class="fragment">
            <code class="normal">0</code>
            <code class="value">01111101</code>
            <code class="value">00100110101100111011111</code>
          </div>
          <p data-id="3" class="fragment">
            <code class="normal">
              y = * (float *) &i;
            </code>
          </p>
          <div data-id="4" class="fragment">
            <code class="normal">0</code>
            <code><span class="ieee-exponent">01111101</span></code>
            <code><span class="ieee-mantissa">00100110101100111011111</span></code>
          </div>
        </section>

        <section data-auto-animate>
          <p data-id="3">
            <code class="normal">
              y = * (float *) &i;
            </code>
          </p>
          <div data-id="4">
            <code class="normal">0</code>
            <code><span class="ieee-exponent">01111101</span></code>
            <code><span class="ieee-mantissa">00100110101100111011111</span></code>
          </div>
          <hr />
          <div class="fragment">
            <code class="normal">
              y = <code class="value">0.287795037031</code>
            </code>
          </div>
          <div class="fragment">
            <pre class="c big">
              <code data-trim >
                // Avec la lib math.h
                y = 1/sqrt(12,5); // 0.28284271247
              </code>
            </pre>
          </div>
        </section>

        <section>
          <h3>En résumé</h3>
          <div class="r-stack">
            <pre class="c clean big fragment preload current-visible">
              <code data-trim data-ln-start-from="8" data-line-numbers="3-4">
                i = * ( long * ) &y;

                // bits de la solution
                i = 0x5f3759df - ( i >> 1 ); 

                y = * ( float * ) &i;
            </code>
            </pre>
            <pre class="c clean big current-visible fragment">
              <code data-trim data-ln-start-from="8" data-line-numbers="5-6">
                i = * ( long * ) &y;

                i = 0x5f3759df - ( i >> 1 );

                // la solution, un float
                y = * ( float * ) &i;
            </code>
            </pre>
            <pre class="c clean big current-visible fragment">
              <code data-trim data-ln-start-from="8" data-line-numbers="5-6">
                i = * ( long * ) &y;

                i = 0x5f3759df - ( i >> 1 );

                // enfin, une approximation...
                y = * ( float * ) &i;
            </code>
            </pre>
            <pre class="c clean big fragment">
              <br/>
              <code data-trim data-ln-start-from="8" data-line-numbers="7-8">
                i = * ( long * ) &y;

                i = 0x5f3759df - ( i >> 1 );

                y = * ( float * ) &i;

                // c'est pour ça qu'on une 3ème étape...
                y = y * ( threehalfs - ( x2 * y * y ) );
            </code>
            </pre>
          </div>
          <img class="fragment harold highlight-shadow" src="/8/harold.png" />
          <aside class="notes">
            - C'est pas la vraie solution, c'est juste une approximation.
            - C'est pour ça qu'on a besoin de la 3ème et dernière étape
          </aside>
        </section>

      </section>

      <!-- 9. L'itération de Newton -->
      <section data-background-image="/9/newton-wallpaper.jpeg" data-transition="fade">
        <br />
        <h3>Étape n°3</h3>
        <h2 class="highlight-gold">L'itération de Newton</h2>
        <aside class="notes">
          Et pour finir cet algorithme, on va parler d'une petite technique de coquin
          qui nous vient de ce bon vieux Newton.
        </aside>
      </section>
      <section data-background-image="/9/newton-wallpaper.jpeg" class="blurred">

        <section>
          <pre class="c wide smaller clean">
          <code data-trim data-line-numbers="11-12">
            float Q_rsqrt( float number ) {
              long i;
              float x2, y;
              const float threehalfs = 1.5F;

              x2 = number * 0.5F;
              y  = number;
              i  = * ( long * ) &y;                        // evil floating point bit level hacking
              i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
              y  = * ( float * ) &i;
              y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
              // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed

              return y;
            }
          </code>
        </pre>
        </section>

        <section>
          <img class="r-stretch" src="/9/isaac-newton.jpeg" />
          <div data-fragment-index="1" class="newton-quote-1 small fragment">
            <q class="bold">Invente la gravité,<br />mais n'attire personne</q><br />- un internaute
          </div>
          <div data-fragment-index="2" class="newton-quote-2 small fragment">
            <q class="bold">C'est trop</q><br />- Isaac Newton
          </div>
          <img data-fragment-index="2" class="highlight-shadow newtons-tear fragment" src="/9/tear.png" />
          <aside class="notes">
            Isaac Newton, le fameux mathématicien anglais qui invite la gravité,
            mais malheureusement n'attire personne et mourra sans avoir connu l'amour.
          </aside>
        </section>

        <section>
          <img class="abs-center god-rays" src="/9/god-rays.png" />
          <h2 class="highlight-gold">La méthode de Newton</h2>
          <div class="fragment">
            <h5>(ou méthode de Newton-Raphson)</h5>
            <h2 class="fragment grow">1669</h2>
            <h4 class="fragment">publiée en 1711</h4>
            <div class="fragment">
              <b class="muted">(version simplifiée par Joseph Raphson en 1690)</b>
            </div>
          </div>
          <aside class="notes">
            Ce qui nous intéresse, c'est la méthode "dite" de Newton, publiée en 1669, ou Newton-Raphson
            (un autre mathématicien anglais du 16ème siècle) qui en publia une version simplifiée en 1690
          </aside>
        </section>

        <section data-auto-animate>
          <h3>Cette méthode c'est quoi ?</h3>
          <blockquote class="fragment">
            <q>
              <span class="fragment">Une méthode <b>itérative</b> de recherche de zéro d'une fonction,</span>
              <span class="fragment"> qui consiste à construire une suite de nombres réels par une <b>méthode géométrique</b>,</span>
              <span class="fragment"> et à montrer que cette suite <b>converge vers le zéro</b> de la fonction</span>
            </q>
          </blockquote>
        </section>

        <section data-auto-animate>
          <h3>Cette méthode c'est quoi ?</h3>
          <div class="r-stack">
            <div class="fragment current-visible big">
              \[f(x)\]
            </div>
            <div class="fragment big">
              \[f(x) = 0\]
            </div>
            <div class="fragment">
              <video data-autoplay loop data-src="/9/winona-confused-math.webm" height="500px"></video>
            </div>
          </div>
          <aside class="notes">
            Pour faire simple : voilà.
            Ok c'est pas giga clair, mais on va voir un exemple.
          </aside>
        </section>

        <section data-auto-animate>
          <video data-id="1" class="r-stretch" data-autoplay data-src="/9/newtons-method.mp4"></video>
          <aside class="notes">
            On part d'un point x1, on calcule la valeur de la fonction en ce point,
            et on trace la tangente à la courbe en ce point.
            On regarde ensuite où cette tangente coupe l'axe des abscisses, et on recommence.
            On obtient une suite de points qui converge vers le zéro de la fonction.
          </aside>
        </section>

        <section data-auto-animate>
          <video data-id="1" class="r-stretch" data-autoplay data-src="/9/newtons-method-2.mp4"></video>
          <aside class="notes">
            On note f(x) la valeur de x sur la courbe, et f'(x) la valeur de la dérivée de f en x.
          </aside>
        </section>

        <section data-auto-animate>
          <video data-id="1" class="r-stretch" data-autoplay data-src="/9/newtons-method-3.mp4"></video>
          <aside class="notes">
            Pour trouver la nouvelle estimation de x, plus proche de 0, on doit calculer le rapport entre f(x) et
            f'(x), soit f(x)/f'(x).
          </aside>
        </section>

        <section data-auto-animate>
          <div data-id="2" class="big">
            \[\textcolor{#C878E1}{\Delta_x} = \frac{f(x_n)}{f'(x_n)}\]
          </div>
        </section>

        <section data-auto-animate>
          <h3>Autrement dit</h3>
          <div data-id="2" class="big">
            \[x_{new} = \textcolor{#C878E1}{x_n} - \frac{f(x_n)}{f'(x_n)}\]
          </div>
          <aside class="notes">
            Autrement dit : la nouvelle valeur de x (ici x_new) est égale à l'ancienne valeur de x (ici x_n)
            moins le rapport entre f(x_n) et sa dérivée, f'(x_n)
          </aside>
        </section>

        <section>
          <div class="cv">
            <div class="item ch">
              <div class="item"><img src="/9/bully-1.png" /></div>
              <div class="item fragment"><img src="/9/bully-2.jpeg" /></div>
            </div>
            <div class="item ch">
              <div class="item fragment"><img src="/9/bully-3.jpeg" /></div>
              <div class="item fragment"><img src="/9/bully-4.jpeg" /></div>
            </div>
          </div>
          <aside class="notes">
            Là vous vous dites "c'est un vraiment un traquenard ce talk, qui l'a mis en keynote",
            ce à quoi je répondrais : c'est bien fait pour vous, en plus j'ai la crève depuis dimanche.
          </aside>
        </section>

        <section data-auto-animate>
          <h3>Exemple avec la fonction</h3>
          <div data-id="1"><b class="bigger">\[\sqrt{x}\]</b></div>
          <div data-id="2" class="fragment"><b>Admettons qu'on cherche $\sqrt{3}$</b></div>
        </section>

        <!-- Première itération -->
        <section data-auto-animate>
          <div data-id="2"><b>Admettons qu'on cherche $\sqrt{3}$</b></div>
          <div data-id="3" class="fragment">Prenons une 1ère estimation : <b class="bright">$y = 2$</b></div>
          <div class="r-stack medium">
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{f(y)}{f'(y)}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{y^{2} - x}{2y}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = 2 - \frac{2^{2} - 3}{2 * 2}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = 2 - \frac{4 - 3}{4}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = 2 - \frac{1}{4}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = 2 - 0,25\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = 1,75\]
            </div>
          </div>
        </section>

        <!-- Première itération -->
        <section data-auto-animate>
          <div data-id="2"><b>Admettons qu'on cherche $\sqrt{3}$</b></div>
          <div data-id="3">Nouvelle estimation : <b class="bright">$y = 1,75$</b></div>
          <div class="r-stack medium">
            <div class="fragment current-visible instant">
              \[x_n = 1,75 - \frac{1,75^{2} - 3}{2 * 1,75}\]
            </div>
            <div class="fragment current-visible instant">
              \[x_n = 1,75 - \frac{3,0625 - 3}{3,5}\]
            </div>
            <div class="fragment current-visible instant">
              \[x_n = 1,75 - \frac{0,0625}{3,5}\]
            </div>
            <div class="fragment current-visible instant">
              \[x_n = 1,75 - 0,017857\]
            </div>
            <div class="fragment current-visible instant">
              \[x_n = 1,732143\]
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <div data-id="2"><b>Admettons qu'on cherche $\sqrt{3}$</b></div>
          <div data-id="3">Nouvelle estimation : <b class="bright">$y = 1,73214$</b></div>
          <div class="r-stack">
            <img class="fragment highlight-shadow" src="/9/sqrt-calculator.png" height="400px" />
            <img class="fragment" src="/9/good-enough.png" height="400px" />
          </div>
        </section>

        <section>
          <h3>Pourquoi je vous raconte tout ça ?</h3>
          <div class="ch fragment">
            <div class="item">
              Parce que nous,<br />on a déjà une <b class="bright">bonne approximation</b> de
              <br />
              <div class="medium">\[\frac{1}{\sqrt{y}}\]</div>
            </div>
            <div class="item">
              <img src="/9/not-bad.jpeg" />
            </div>
          </div>
          <aside class="notes">
            Cependant, on a récupérer des petites erreurs par-ci par là, et on aimerait bien les corriger.
            On va utiliser cette méthode pour affiner notre résultat
          </aside>
        </section>

        <section data-auto-animate>
          <div><b class="regular">On applique la méthode, mais avec $\frac{1}{\sqrt{x}}$</b></div>
          <div class="r-stack medium">
            <div class="fragment preload current-visible instant">
              \[y_n = y - \frac{f(y)}{f'(y)}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{\frac{1}{y^{2}} - x}{\frac{-2}{y^3}}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{\frac{y^3}{y^{2}} - xy^{3}}{-2}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{y - xy^{3}}{-2}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y - \frac{y}{-2} + \frac{-xy^{3}}{-2}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y + \frac{y}{2} - \frac{xy^{3}}{2}\]
            </div>
            <div class="fragment current-visible instant">
              \[y_n = y * \left(\frac{3}{2} - \frac{xy^{2}}{2}\right)\]
            </div>
            <div class="fragment instant">
              \[y_n = y * \left(1,5 - (x/2 * y * y)\right)\]
            </div>
          </div>
          <div class="fragment">
            <pre data-id="1" class="c small">
              <code data-trim>
                const float threehalfs = 1.5F;
                x2 = number * 0.5F;
                ...
                y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
              </code>
            </pre>
          </div>
          <aside class="notes">
            - Y'a plus qu'à résoudre ça.
            - On va commencer par multiplier le numérateur et le dénominateur par y^3
            - y^3/y^2 ça fait y, easy
            - On sépare la division en 2
            - On simplifie les signes
            - on met y en facteur
            - est-ce que ça vous rappelle un truc ?
          </aside>
        </section>

        <section data-auto-animate>
          <pre data-id="1" class="c wide smaller">
            <code data-trim data-line-numbers data-ln-start-from="12">
                y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed
            </code>
          </pre>
          <br />
          <div class="fragment">
            <a href="https://www.desmos.com/calculator/yoz6n1wlvu?lang=fr" target="_blank">
              <img src="/9/graph.png" height="400px" />
            </a>
          </div>
          <aside class="notes">
            CONTROL + SHIFT + TAB
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <div>
              <pre class="c wide smaller clean">
                <code data-trim data-line-numbers="14">
                  float Q_rsqrt( float number ) {
                    long i;
                    float x2, y;
                    const float threehalfs = 1.5F;
      
                    x2 = number * 0.5F;
                    y  = number;
                    i  = * ( long * ) &y;                        // evil floating point bit level hacking
                    i  = 0x5f3759df - ( i >> 1 );                // what the fuck?
                    y  = * ( float * ) &i;
                    y  = y * ( threehalfs - ( x2 * y * y ) );    // 1st iteration
                    // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, can be removed
      
                    return y;
                  }
                </code>
              </pre>
            </div>
            <div class="fragment">
              <img src="/9/isaac-face.jpeg" />
            </div>
          </div>
        </section>

      </section>

      <!-- 10. Conclusion -->
      <section data-background-image="/10/quake-3-sarge.webp" data-transition="fade">
        <h2>10.<br />Conclusion</h2>
        <aside class="notes">
          - gain de temps ? (3 à 4 fois plus rapide)
          - finalement, qui est à l'origine de ce bout de code ? (l'investigation)
        </aside>
      </section>
      <section data-background-image="/10/quake-3-sarge.webp" class="blurred">

        <section>
          <h3>On récapitule ⏰</h3>
          <br />
          <ul class="small">
            <li class="fragment">Pour un <code class="type">float</code>, on veut sa <b>racine carrée inversée</b></li>
            <li class="fragment">
              <b>Étape n°1 :</b>
              <ul>
                <li>On récupère les <code class="value">bits</code> de ce <code class="type">float</code> dans un <code
                    class="type">long</code></li>
              </ul>
            </li>
            <li class="fragment">
              <b>Étape n°2 :</b>
              <ul>
                <li class="fragment">On bitshift ce <code class="type">long</code> pour <b>diviser l'exposant par 2</b>
                </li>
                <li class="fragment">On le soustrait au <code class="emphas">magic number</code></li>
              </ul>
            </li>
            <li class="fragment">
              <b>Étape n°1 (bis) :</b>
              <ul>
                <li class="fragment">On récupère nos <code class="value">bits</code> dans notre <code
                    class="type">float</code></li>
              </ul>
            </li>
            <li class="fragment">
              <b>Étape n°3 :</b>
              <ul>
                <li class="fragment">On lui applique une itération de <b>la méthode Newton</b></li>
              </ul>
            </li>
            <li class="fragment">Et le tour est joué 🎉 !!</li>
          </ul>
        </section>

        <section>
          <h3>À quel point c'est précis ?</h3>
          <h2 class="fragment"><code class="normal">Erreur relative maximum :</code>
            <code class="bright">0,177%</code>
          </h2>
        </section>

        <!-- le gain de temps -->
        <section>
          <h3>À quel point c'est rapide ?</h3>
          <div class="fragment">
            <img src="/10/mr-wolf.jpeg" height="400px" />
            <h3><span class="bright">3-4 fois</span> plus rapide que <code class="normal">1/sqrt(x)</code></h3>
            <p class="small muted">à l'époque</p>
          </div>
          <aside class="notes">
            On estime qu'à l'époque cet algorithme était 3 à 4 fois plus rapide que la méthode classique.
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <img src="/10/intel-pentium-3.webp" height="500px" />
            <img class="fragment" src="/10/fast-sonic.jpeg" height="500px" />
          </div>
          <p><b>Intel Pentium-3 CPU/FPU<br />Février 1999</b></p>
          <aside class="notes">
            - Peu de temps après cependant, et dès février 1999, donc avant la sortie de Quake 3
            (sorti en décembre de la même année) le set d'instructions SSE est introduit par Intel
            dans son nouveau Pentium-3, comprenant une instruction "RSQRTSS"
            - Rapidement, l'algo est devenu obsolète, et a été remplacé par ces instructions.
          </aside>
        </section>

        <!-- l'enquête Beyond3D -->
        <section>
          <h3>Qui a écrit ce code ?</h3>
          <div class="r-stack">
            <img src="/10/thinking-cat.jpeg" />
            <img class="fragment" src="/10/john-carmack-2006.jpeg" height="500px" />
          </div>
          <aside class="notes">
            - Une question qui reste en suspens est : qui a écrit cet algo au final ?
            - On a longtemps attribué ce code à John Carmack, étant donné sa notoriété et son implication en tant que
            développeur sur les moteurs de jeux et dans les projets d'iD Software de l'époque.
          </aside>
        </section>

        <section>
          <div class="r-stack">
            <div>
              <img class="round" src="/10/rys-sommefeldt.jpeg" width="100%" />
              <p>
                <b>Rys Somerfeldt</b>
                <br />
                <span class="muted">beyond3d.com</span>
              </p>
            </div>
            <img class="fragment" src="/10/detectiv-stonks.png" />
          </div>
          <aside class="notes">
            Cependant, grâce à une enquête de Rys Sommefeldt, éditeur sur le blog / forum Beyond3D à l'époque
            on a pu retracer via 2 articles l'origine de ce code.
            Les premières pistes indiquaient naturellement John, mais aussi Michael Abrash, un employé d'id Software
            lors de la conception de Quake 1.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/10/john-carmack-conf.jpeg" />
            </div>
            <div class="item fragment">
              <br />
              <blockquote class="large">
                "Not me, and I don't think it is Michael.<br /><br /><b>Terje Matheson</b> perhaps?"
              </blockquote>
            </div>
          </div>
          <aside class="notes">
            En 2006, date de l'article, lorsqu'il est interrogé sur le sujet Carmack répond
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/10/michael-abrash.webp" />
              <p><b>Michael Abrash</b></p>
            </div>
            <div class="item">
              <br />
              <br />
              <blockquote class="fragment large">
                "After you finish <br /><b>the first 90%</b><br /> of a project,<br /> you have to finish <br /><b>the
                  other 90%</b>"
              </blockquote>
            </div>
          </div>
          <aside class="notes">
            - Michael Abrash, recruté par iD Software en 1990 pour le développement du premier Quake
            est un expert de l'optimisation du code assembleur.
            - Il est notamment à l'origine d'une citation que j'aime beaucoup
            (c'est bien une phrase de mec qui optimise tout ça)
            - Depuis 2014 et encore aujourd'hui il est Chief Scientist chez Oculus VR.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/10/terje-mathisen.png" height="500px" />
              <p><b>Terje Matheson</b></p>
            </div>
            <div class="item fragment">
              <br />
              <br />
              <blockquote class="large">
                "I wrote a very fast [...] invsqrt() 5+ years ago"
                <br />
                <br />
                "The code <b>is not the same</b> as what I wrote"
                <br />
              </blockquote>
            </div>
          </div>
          <aside class="notes">
            - A aussi donné un coup de main sur l'optim de Quake
            - Est aussi un maitre de l'optim ASM pour x86
            Il a dit avoir écrit un algo très similaire 5 ans plus tôt pour une boite de biotechnoligue suédoise.
          </aside>
        </section>

        <section>
          <img src="/10/google-that.png" />
          <aside class="notes">
            Après des recherches de qualité sur Google, Rys retrouve une piste chez 3DFX
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img src="/10/brian-hook-1.gif" width="100%" />
              <p><b>Brian Hook</b></p>
            </div>
            <div class="item">
              <img src="/10/brian-hook-2.jpeg" width="100%" />
            </div>
          </div>
          <aside class="notes">
            Brian bossait chez 3DFX avec Gary à l'époque, avant d'être recruté chez id Software pour pallier
            au départ de Michael Abrash, et c'est certainement comme ça que l'algo est arrivé dans le code source.
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item">
              <img class="highlight" src="/10/3dfx-logo.png" />
              <img class="highlight fragment" src="/10/nvidia-logo.png" />
            </div>
            <div class="item fragment">
              <img src="/10/gary-tarolli.jpeg" />
              <p><b>Gary Tarolli</b></p>
            </div>
          </div>
          <aside class="notes">
            En creusant un peu les internet, on trouve une autre piste.
            Elle mène à Gary Tarolli, un ancien employé de 3DFX, racheté en 2000 par NVIDIA.
            Gary Tarolli was consulting for Kubota, the company funding Ardent at the time, and likely brought the
            algorithm to 3dfx Interactive circa 1994.
          </aside>
        </section>

        <section>
          <blockquote>
            <p class="fragment">
              "So it did pass by my keyboard many many years ago, I may have tweaked
              the hex constant a bit or so, but other than that <b>I can't take credit
                for it.</b>
            </p>
            <br />
            <p class="fragment">
              I may have done this for the IRIS indigo work I did,
              or some consulting at <b>Kubota</b>, I'm not 100% sure."
            </p>
            - Gary Tarolli
          </blockquote>
        </section>

        <section>
          <img src="/10/investigation.jpeg" height="600px" />
          <aside class="notes">
            La piste s'arrête là, est-ce qu'on saura un jour ?
          </aside>
        </section>

        <section>
          <div class="ch">
            <div class="item r-stack">
              <img class="highlight-shadow" src="/10/silhouette-question-mark.png" height="500px" />
              <div class="fragment">
                <br />
                <img src="/10/greg-walsh.gif" height="500px" />
                <p><b>Greg Walsh</b></p>
              </div>
            </div>
            <div class="item fragment">
              <br />
              <img src="/10/cleve-moler.webp" />
              <p><b>Cleve Moler</b></p>
            </div>
          </div>
          <aside class="notes">
            Le gars s'est réveillé quand l'article a gagné en popularité.
            À l'époque où Gary Tarolli travaillait pour Kubota, et Kubota financait Ardent Computer Corporation.
            Greg Walsh travaillait là bas.
            C'est lui qui a écrit l'algorithme, inspiré par Cleve Moler, Auteur de MalWorks et MatLab.
            Comment Cleve a entendu parlé de cette technique ?
          </aside>
        </section>

        <section>
          <img src="/10/william-kahan.jpeg" />
          <p>
            <b>William Kahan</b>
            <br />
            <b class="fragment highlight-gold">« The Father of Floating Point »</b>
          </p>
          <aside class="notes">
            - mathématicien et informaticien canadien né en 1933 (il a 90 ans aujd),
            - lauréat du prix Turing en 1989 pour ses travaux en analyse numérique.
            - Spécialiste des calculs en virgule flottante, il est le principal architecte de la norme IEEE 754.
          </aside>
        </section>

        <section>
          <img src="/10/e-sqrt-c.png" height="550px" />
          <br />
          <a href="https://www.netlib.org/fdlibm/e_sqrt.c"><b>e_sqrt.c</b></a>
          <aside class="notes">
            William Kahan and K.C. Ng at Berkeley wrote an unpublished paper in May 1986 describing
            how to calculate the square root using bit-fiddling techniques followed by Newton iterations
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/10/morale.jpeg" />
          <aside class="notes">
            - Maintenant vous savez comment votre ordi stocke des float,
            - Vous savez à peu près comment fonctionne l'algorithme
          </aside>
        </section>

        <section>
          <img class="r-stretch" src="/10/pride-only-hurts.png" />
          <aside class="notes">
            - Pour finir, je vous laisse sur cette citation de Marsellus Wallace
            - Sachons rester humble, à l'image de tous ces gens dans cette enquête, qui malgré être des
            monstres dans leur domaine, refusent poliment de s'attribuer seul les lauriers,
            et ne s'enorgueillissent jamais de leurs travaux.
            - Souvenons nous de cet algo, qui, bien qu'obsolète dès sa sortie au regard de la nouvelle génération de CPU, 
            aura permis à une génération de joueurs de profiter de Quake 3 sur leurs bécanes pourries.
            (ordis du CDI)
            - Prenons en de la graine, restons connectés à nos racines (pas carrées)
            et chargés de ces enseignements, embrassons le futur de notre métier.
          </aside>
        </section>

      </section>

      <!-- 11. Merci -->
      <section data-background-image="/1/cake-aux-olives.jpeg" data-transition="fade">
        <h1>Merci !</h1>
        <strong class="shadow">Distribution de paracétamol<br />à la pause</strong>
        <aside class="notes">
          j'espère que ça vous a plu, merci de m'avoir écouté.
        </aside>
      </section>
    </div> <!-- /slides -->
  </div> <!-- /reveal -->

  <!-- Scripts -->
  <script type="module" src="/phaser.js"></script>
  <script type="module" src="/three.js"></script>
  <script type="module" src="/main.js"></script>
</body>

</html>